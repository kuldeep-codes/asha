<div class="section is-uniform position-relative" id="unit-inner-section">
<h1 class="margin-right-xxl-desktop" id="module-unit-title">Introduction</h1>


<div hidden="" id="module-unit-notification-container"></div>
<p>To reduce build time and ensure that you're always running the latest
version of finance and operations apps, you can't modify base code and no
Microsoft models can be overlayered.</p>
<p>Binary updates are provided to finance and operations apps monthly, to reduce
upgrade cost and deliver innovation to customers at a faster speed. Avoid intrusive customizations because it can impact those upgrade costs.</p>
<p>Finance and operations apps are customized by using extensions, which allow
you to add functionality to model elements and source code in the
Application Object Tree (AOT) by using Visual Studio. When a customization can't be accomplished by using an extension, you can submit an extensibility request support ticket. You can also write new code by using X++ to customize the functionality of the application. Event handlers and methods can be added to elements through extensions to change their behavior.</p>
<div class="modular-content-container" hidden="" id="next-section">
</div>
</div>
<div class="section is-uniform position-relative" id="unit-inner-section">
<h1 class="margin-right-xxl-desktop" id="module-unit-title">Customization models</h1>


<div hidden="" id="module-unit-notification-container"></div>
<p>Extensions provide a seamless update process for developers. While it
can take less time to modify base code, this isn't an option in finance
and operations apps. While overlaying could potentially save time up front,
you would end up spending much more time later fixing code after an
update or hotfix is rolled out to the application. Customizations that
are made by using overlaying require code upgrades, more time to
recompile code, and extensive, costly testing. The costs that are involved in these tasks can make upgrading to newer versions of the applications daunting. Because models with overlayered customizations are contained in the same package as the base objects, the compile cycles take longer to perform and package distributions are larger.</p>
<p>Most elements in the AOT can be extended if you're referencing the
necessary models. If you attempt to create an extension and notice that the <strong>Create extension</strong> option appears dimmed, this is an indication that you need to update your model parameters.</p>
<p><a data-linktype="relative-path" href="media/create-new-extension.png#lightbox"><img alt="Graphic showing the create extension option not available." data-linktype="relative-path" src="https://learn.microsoft.com/en-us/training/modules/explore-extensions-framework-finance-operations/media/create-new-extension.png"/></a></p>
<p>You can update the models that you're referencing through the <strong>Model
management</strong> option by selecting <strong>Update model parameters</strong>. A dialog
box will open, allowing you to choose the model that you want your
project to reside in, and then you can select more model
references.</p>
<p>The most common models to reference are ApplicationCommon,
ApplicationFoundation, ApplicationPlatform, ApplicationSuite, and
Directory.</p>
<p>To update model parameters, follow these steps:</p>
<ol>
<li>In Visual Studio, select the <strong>Dynamics 365</strong> menu in the ribbon.</li>
<li>Select the <strong>Model Management</strong> menu.</li>
<li>Select <strong>Update model parameters</strong>.</li>
<li>In the <strong>Model name</strong> field, select your model from the drop-down menu. Select <strong>Next</strong>.</li>
<li>On the <strong>Select referenced packages</strong> page, select the box next to the models that you want to reference, meaning the models you want to use to create extensions.</li>
<li>Select <strong>Next</strong>. You'll see a summary of the models that you've selected.</li>
<li>Select <strong>Finish</strong>.</li>
</ol>
<p>Extension models can be created by using the <strong>Create model</strong> wizard. In the <strong>Select package</strong> window, select the <strong>Create a new package</strong> option instead of <strong>Select existing package</strong>.</p>
<p>To create a new extension model:</p>
<ol>
<li>Go to <strong>Dynamics 365 &gt; Model Management &gt; Create model</strong>.</li>
<li>Enter the model’s name, description, and package type.</li>
<li>Define references and dependencies for your model.</li>
<li>Select <strong>Finish</strong>.</li>
</ol>
<p>Extension models simplify and improve the performance of builds, test automation, deployments, and delivery to customers. From a service standpoint, Microsoft installs, patches, and upgrades in the cloud so that your customizations aren't affected. With an extension model, performing a build doesn't force a recompile of the whole application.</p>
<h2 id="best-practices-for-extensions">Best practices for extensions</h2>
<p>To ensure efficient and maintainable customizations in finance and Operations apps, we recommend following these best practices when using extensions:</p>
<ul>
<li><strong>Reference only necessary models</strong> - Include only the required models for your extension to reduce compile times and dependency management overhead.</li>
<li><strong>Keep customizations modular and reusable</strong> - Break down large extensions into smaller, independent modules wherever possible and design extensions to be reusable across multiple projects or environments.</li>
<li><strong>Adhere to naming conventions</strong> - Use clear and consistent naming for your models and extensions to avoid confusion.</li>
<li>Document customizations** - Maintain detailed documentation for each extension.</li>
</ul>
<div class="modular-content-container" hidden="" id="next-section">
</div>
</div>
<div class="section is-uniform position-relative" id="unit-inner-section">
<h1 class="margin-right-xxl-desktop" id="module-unit-title">Extension points for frameworks</h1>


<div hidden="" id="module-unit-notification-container"></div>
<p>When a change needs to be propagated through the entire application, you should create an extension of that element to modify properties or components.</p>
<p>The following is an overview of common element types and the reasons for creating an extension of an element:</p>
<ul>
<li><strong>Labels</strong> - You would create a label extension file to modify the values of a label, add new labels, or add new languages. Label file    extensions are named with an <code>_extension</code> suffix, such as <strong>FLM_Extension</strong>.</li>
<li><strong>Enumeration</strong> (enum) - If the <code>IsExtensible</code> property is set to <strong>True</strong>, an enum can be extended to add new values to it.</li>
<li><strong>Extended data types (EDTs)</strong> - You can modify properties for an EDT, such as the label, string size, or help text by creating an extension, if <strong>String Size Is Extensible</strong> is set to <strong>Yes</strong>.</li>
<li><strong>Tables</strong> - You can extend a table to add new fields, indexes, or    relations, and modify properties for the table elements or the table. You can also implement event handlers that are called from the base implementations of the table methods.</li>
<li><strong>Data entities</strong> - Provide a denormalized version of underlying table schemas. Data entities can be extended for many of the same    reasons as tables and can also be extended to add data sources.</li>
<li><strong>Forms</strong> - Can be extended to add a new data source, add a new control, or modify properties such as labels, help text, and captions. Like tables, you can implement event handlers that are called from the base implementations of form methods.</li>
<li><strong>Menus</strong> - Menus, such as the main menu, are extended to add new    menu items, submenus, or menu references or to hide any of these    items. For example, if you created a new module, you would extend the main menu (Navigation pane) to add your submenu to it.</li>
</ul>
<p>While many extension capabilities exist, some customizations cannot be completed by using extensions. To achieve these customizations, you need to log a request with Microsoft that specifies your needs. These requests are logged in a specific project in Lifecycle Services. Related requests should be logged under the same project so Microsoft has a complete view of all requests for a specific implementation. In your Lifecycle Services project, you select the hamburger icon in the top-middle of the screen and select <strong>Support</strong> to view logged extensibility requests and/or to create a new extensibility request. Your extensibility request is then added to a backlog that is worked on by engineers. If a request is considered too intrusive, it is not be supported because it could prevent a seamless upgrade.</p>
<p>Intrusive customizations are one of the main obstacles to keeping
continuous upgrade costs as low as possible. When compiling code, Visual
Studio prevents some types of intrusive customizations, but not all
are detected.</p>
<p>Follow these guidelines to help ensure that you are not performing customizations that are too intrusive:</p>
<ul>
<li>A type's definition should not be changed because it is a breaking change that requires the update of all references. Ensuring that future references are implemented correctly is impossible if the type    definition is changed.</li>
<li>A model's author should remain in control of encapsulated code and    types to make improvements to the application.</li>
<li>Adding new behaviors is encouraged and is enabled by using extensions.</li>
<li>Extension capabilities must be designed as open for extensions, and    they must support multiple extensions that exist side by side in the    same installation.</li>
</ul>
<p>To create an extension (in general terms), follow these steps:</p>
<ol>
<li>In the <strong>Application Explorer</strong> window, expand the <strong>AOT</strong> node.</li>
<li>Expand the node for the element that you want to extend. For example, in Classic view, extend the <strong>Data Models</strong> node, and then    extend the <strong>Tables</strong> node to view all available tables.</li>
<li>Right-click the element that you want to extend.</li>
<li>Select <strong>Create extension</strong> to add an extension to your current project. Select <strong>Create extension in new project</strong> if you want to add the extension to a new project. The element is added to a project in the <strong>Solution Explorer</strong> window, and it opens in the element designer.</li>
</ol>
<div class="modular-content-container" hidden="" id="next-section">
</div>
</div>
<div class="section is-uniform position-relative" id="unit-inner-section">
<h1 class="margin-right-xxl-desktop" id="module-unit-title">Develop code to extend a framework</h1>


<div hidden="" id="module-unit-notification-container"></div>
<p>When you need to change the behavior of an element, you create an
extension of that element. Some elements require code to be written to
change their behavior, such as adding an event handler. In other cases,
you might create a class extension to change an element's makeup.</p>
<h2 id="class-extensions">Class extensions</h2>
<p>To extend the business logic that is related to a table, you create an augmentation class. If you wanted to add another ID field to the table and have it filled, you would create a data event handler for the Inserting event and then implement the logic to fill the new field in that event handler. You can create a class that augments the table and enables access to the table's fields and methods in an easy-to-read manner. When creating a class extension, you must decorate it with the <code>ExtensionOf</code> attribute, use the <code>_Extension</code>
suffix, and indicate the class as <code>final</code>.</p>
<p>The following is an example of creating a class that extends
<code>InventTable</code>. Methods can then be added to this
augmented class where the comment is used.</p>
<pre><code class="lang-xpp">[ExtensionOf(tableStr(InventTable))]
final class InventTableNew_Extension
{
 	public void newDefaultInventLocationId()
	 {
	 //enter your code here
	 }
}
</code></pre>
<h2 id="event-handlers">Event handlers</h2>
<p>An event handler is a way for you to write or copy code to an element that runs when a certain event occurs, such as when a field is modified or a record is deleted. Some elements, like tables and forms, contain an <strong>Events</strong> node in the designer window that, when expanded, lists all the events that are associated with that element. If you need to add supplementary behavior that doesn't currently exist in an element, you should create an extension of that element, and then add an event handler to the extended element.</p>
<p>The following are methods for event handlers that are pulled from the <code>CustTable</code> table. These methods can be copied and added to your extended element or class by right-clicking the event in the element designer window and selecting <strong>Copy event handler method</strong>.</p>
<p><a data-linktype="relative-path" href="media/copy-event-handler.png#lightbox"><img alt="Visual Studio screenshot showing how to copy event handler method from
the table designer
window." data-linktype="relative-path" src="https://learn.microsoft.com/en-us/training/modules/explore-extensions-framework-finance-operations/media/copy-event-handler.png"/></a></p>
<ul>
<li><strong><code>OnDeleted</code> event</strong> - This is a post-event handler that triggers when a record is deleted in the table. You could use this, for example, to display an Infolog message after a record is deleted.</li>
</ul>
<pre><code class="lang-xpp">/// &lt;summary&gt;
///
/// &lt;/summary&gt;
/// &lt;param name="sender"&gt;&lt;/param&gt;
/// &lt;param name="e"&gt;&lt;/param&gt;
[DataEventHandler(tableStr(CustTable), DataEventType::Deleted)]
public static void CustTable_onDeleted(Common sender, DataEventArgs e)
{
}
</code></pre>
<ul>
<li><strong><code>OnInserting</code> event</strong> - This is triggered when data
is being inserted. For example, this could trigger when you add a  new customer to finance and operations apps.</li>
</ul>
<pre><code class="lang-xpp">/// &lt;summary&gt;
///
/// &lt;/summary&gt;
/// &lt;param name="sender"&gt;&lt;/param&gt;
/// &lt;param name="e"&gt;&lt;/param&gt;
[DataEventHandler(tableStr(CustTable), DataEventType::Inserting)]
public static void CustTable_onInserting(Common sender, DataEventArgs e)
{
}
</code></pre>
<ul>
<li><strong><code>OnValidatedWrite</code> event</strong> - This is a post-event
handler that triggers after data is entered. This is used to
validate data that is being written to a page, such as ensuring that a customer is at least 18 years old by verifying a birth date.</li>
</ul>
<pre><code class="lang-xpp">/// &lt;summary&gt;
///
/// &lt;/summary&gt;
/// &lt;param name="sender"&gt;&lt;/param&gt;
/// &lt;param name="e"&gt;&lt;/param&gt;
[DataEventHandler(tableStr(CustTable), DataEventType::ValidatedWrite)]
public static void CustTable_onValidatedWrite(Common sender, DataEventArgs e)
{
}
</code></pre>
<h2 id="chain-of-command">Chain of Command</h2>
<p>You can wrap logic around methods that are defined in the base class that you're augmenting. You can also extend the logic of public and protected
methods without having to use event handlers.</p>
<p>When wrapping a method, you can access public and protected methods as
well as variables of the base class. Using a wrapper around a method and
the <code>next</code> keyword creates a Chain of Command (CoC).</p>
<p>CoC is a design pattern where a request is handled by a series of
receivers. An extension class is used to wrap protected or public
methods of classes, tables, data entities, and forms. You should be aware of some restrictions when wrapping methods:</p>
<ul>
<li>The wrapper method must have the same signature as the base method.</li>
<li>When you augment form classes, only root-level methods can be    wrapped, not methods that are defined in nested classes.</li>
</ul>
<p>Wrapper methods in an extension class are required to always call
<code>next</code> so that the <code>next</code> method in the chain
and, finally, the original implementation is always called. This process ensures that every method in the chain factors into the result. The method must call <strong><code>next()</code></strong> unconditionally.</p>
<div class="modular-content-container" hidden="" id="next-section">
</div>
</div>
<div class="section is-uniform position-relative" id="unit-inner-section">
<h1 class="margin-right-xxl-desktop" id="module-unit-title">Create pre-event and post-event handler classes</h1>


<div hidden="" id="module-unit-notification-container"></div>
<p>You can use event handler classes for pre-handlers and post-handlers to extend an application, like how you’d use Chain of Command (CoC) for method wrapping.</p>
<p>An event handler class is another way to extend an application, and you use it as you would other event handler classes. You can use pre-handlers and post-handlers in a class where the original method has a pre-handler that runs before the original method and a post-handler that you would implement afterward. Handlers surround the original method. Additionally, you can use attributes to prevent or allow extending pre-handlers and post-handlers.</p>
<h2 id="pre-event-and-post-event-classes">Pre-event and post-event classes</h2>
<p>To add a pre-event and post-event class, create a new event handler class. You can add a class to a project from the <strong>Solution Explorer</strong> window by right clicking the project or activating the context menu and then selecting <strong>Add</strong>, <strong>New item</strong>, <strong>Code</strong>, <strong>Class</strong> or <strong>Add Class</strong>.</p>
<p>Enter a descriptive name for the pre-event and post-event class, such as <strong>CustTableTableEventHandler</strong>. It’s best practice to use the object name as a starting point, such as <strong>CustTable</strong>, and then add the object type, such as <strong>Table</strong>, because CustTable could be a table or a form. Then, you can append it with <strong>EventHandler</strong>. For example, you could have two event handler classes that are named <strong>CustTableTableEventHandler</strong> and <strong>CustTableFormEventHandler</strong>.</p>
<p>To add a pre-event or post-event, make sure that the method that’s in the event handler class is discoverable. On the method, right-click or activate the context menu, select <strong>Copy event handler method</strong>, and then select <strong>Pre-event handler</strong>, as the following image depicts.</p>
<p><a data-linktype="relative-path" href="media/copy-eventhandler-method.png#lightbox"><img alt="Visual Studio screenshot showing how to copy event handler method from
and then select Pre-event handler." data-linktype="relative-path" src="https://learn.microsoft.com/en-us/training/modules/explore-extensions-framework-finance-operations/media/copy-eventhandler-method.png"/></a></p>
<p>After you select the pre-event handler, go to the event handler class, and then paste the method. Return to the method, select the post-event handler, and then paste it in the event handler class.</p>
<p>Two methods for pre-events and post-events should display, and the original method is called between these two methods (super call), as the following code sample illustrates:</p>
<pre><code class="lang-xpp">internal final class CustTableTableEventHandler
{
    /// &lt;summary&gt;
    ///
    /// &lt;/summary&gt;
    /// &lt;param name="args"&gt;&lt;/param&gt;
    [PreHandlerFor(tableStr(CustTable), tableMethodStr(CustTable, insert))]
    public static void CustTable_Pre_delete(XppPrePostArgs args)
    {
        CustTable custTable = args.getThis() as CustTable;

        // do something
    }

    /// &lt;summary&gt;
    ///
    /// &lt;/summary&gt;
    /// &lt;param name="args"&gt;&lt;/param&gt;
    [PostHandlerFor(tableStr(CustTable), tableMethodStr(CustTable, insert))]
    public static void CustTable_Post_delete(XppPrePostArgs args)
    {
        CustTable custTable = args.getThis() as CustTable;

        // do something
    }
}
</code></pre>
<h2 id="attributes">Attributes</h2>
<p>You can add attributes to a method to prevent people from using pre-handlers and post-handlers and other extensions. The three types of attributes that you can add are hookable, wrappable, and replaceable.</p>
<p>Hookable attributes complete the following actions:</p>
<ul>
<li><strong>[Hookable(false)]</strong> - Overrides the behavior so that it’s not possible to create pre-events and post-events, which means that the method isn’t wrappable.</li>
<li><strong>[Hookable(true)]</strong> - Overrides the behavior so that it’s possible to create pre-events and post-events.</li>
</ul>
<p>Wrappable attributes complete the following actions:</p>
<ul>
<li><strong>[Wrappable(false)]</strong> - Overrides the default capability for (non-final) public and protected methods to be wrapped, so it’s no longer possible to wrap the method. In other words, the method isn’t wrappable.</li>
<li><strong>[Wrappable(true)]</strong> - Overrides the behavior of not being able to wrap methods that are marked as <strong>final</strong>, so it is possible to wrap the method. In other words, the method becomes wrappable.</li>
</ul>
<p>Replaceable attributes complete the following actions:</p>
<ul>
<li><strong>[Replaceable (false)]</strong> - Overrides the behavior so that Chain of Command (CoC) must have an unconditional next call.</li>
<li><strong>[Replaceable (true)]</strong> Overrides the behavior so that it’s possible to have a CoC extension, but they don’t need to unconditionally call <strong>next</strong>.</li>
</ul>
<p>The replaceable method must also be wrappable.</p>
<p>The following code example shows that the method is protected to have pre-events and post-events and CoC by using [Hookable(false), Wrappable(false)], which means that no extensibility is available.</p>
<pre><code class="lang-xpp">    /// &lt;summary&gt;
    /// Calculates and sets the &lt;c&gt;AmountCur&lt;/c&gt; field using the &lt;c&gt;Quantity&lt;/c&gt; and &lt;c&gt;UnitPrice&lt;/c&gt;
    /// values.
    /// &lt;/summary&gt;
    /// &lt;param name="_qty"&gt;
    /// Item quantity on the line.
    /// &lt;/param&gt;
    /// &lt;returns&gt;
    /// The &lt;c&gt;AmountCur&lt;/c&gt; value.
    /// &lt;/returns&gt;
    [Hookable(false), Wrappable(false)]
    public AmountCur calcLineAmount(Qty _qty = this.Quantity)
    {
        return this.salesPurchLineInterface().calcLineAmount(_qty);
    }
</code></pre>
<p>When you’re using attributes for methods, make sure that you’re aware of extensibility and potentially breaking it.</p>
<div class="modular-content-container" hidden="" id="next-section">
</div>
</div>
<div class="section is-uniform position-relative" id="unit-inner-section">
<h1 class="margin-right-xxl-desktop" id="module-unit-title">Implement the SysOperationSandbox framework</h1>


<div hidden="" id="module-unit-notification-container"></div>
<p>Finance and operations apps provides several ways for you to run time-consuming operations.</p>
<ul>
<li>You can use batch processes to perform lengthy tasks that are implemented on the batch servers.</li>
<li>Occasionally, you'll need to run processes in the web client. If you run the process in synchronous mode, the web browser will be frozen until the process completes. The Application Object Server (AOS) might disconnect the client if the process takes too long, which will eventually fail the process that was running in the web client. To avoid this situation, you can run an asynchronous process, which will leave the web client free for the user.</li>
<li>You can use the SysOperationSandbox framework, which will implement the long running process in a separate session in async mode. Additionally, it shows the waiting page for the async process, without having the user interface frozen. It also has a <strong>Cancel</strong> button to abandon the process.</li>
</ul>
<h2 id="sysoperationsandbox">SysOperationSandbox</h2>
<p>By using SysOperationSandbox, you can run a synchronous operation on the asynchronous session that's happening on the web client. The framework will help you run two client sessions in parallel. The first session is an async session that runs the business logic in a static class. The second session communicates with the user interface to keep it live without allowing a timeout. As a result, you can run a synchronous session in a form without the risk of the web client disconnecting.</p>
<p>The sandbox framework creates a new instance of class and runs it in an asynchronous mode. After the class has completed implementation, the synchronous process will continue. The framework can marshal the state of the current instance to the new instance by using the pack()/unpack() method prior to starting the run() method. The same process continues when the new instance is back to the current instance. Hence, the state of the class must be properly serialized in the pack() and unpack() methods, which is already available for classes that are derived from RunBaseBatch.</p>
<h3 id="example">Example</h3>
<p>A custom table called BankCheque has two fields: <strong>BankAccount</strong> and <strong>CheckNo</strong>. You need to run a user interface-driven process to add 100 new check numbers, starting from 10000, by using the sandbox framework.</p>
<ol>
<li>Create a new class with business logic to create 100 new check numbers. Pack and unpack methods are also created in the class.</li>
</ol>
<pre><code class="lang-xpp">class SandBoxLabHelper
{
    public static container AsyncInfo(container _parameters)
    {

        str bankAccount = conPeek(_parameters, 1);
        int checkStart = conPeek(_parameters, 2);
        int checkCount = conPeek(_parameters, 3);
        
        BankChequeTable   bankChequeTable;

        for(int i = checkStart; i &lt; (checkStart + checkCount); i++)
        {
            bankChequeTable.clear();
            bankChequeTable.AccountID = bankAccount;
            bankChequeTable.ChequeNum = int2Str(i);
            bankChequeTable.insert();
        }
        return [true];
    }

    public container pack()
    {
        return conNull();
    }

    public boolean unpack(container _packedClass)
    {
        return true;
    }

	}
</code></pre>
<ol start="2">
<li>Create a new form and add a button. Write code in the clicked() method of the button to run the preceding AsyncInfo static method by using the sandbox framework.</li>
</ol>
<pre><code class="lang-xpp">public void clicked()
{
   boolean result;
   container mCon;
   mCon = conIns(mCon, 1, "1111111111");
   mCon = conIns(mCon, 2, 100000);
   mCon = conIns(mCon, 3, 100);
            
   [result] = SysOperationSandbox::callStaticMethod(classNum(SandBoxLabHelper), staticMethodStr(SandBoxLabHelper, AsyncInfo), mCon, "Processing", "Completed", "Cancelled");
   super();
}
</code></pre>
<div class="modular-content-container" hidden="" id="next-section">
</div>
</div>
<div class="section is-uniform position-relative" id="unit-inner-section">
<h1 class="margin-right-xxl-desktop" id="module-unit-title">Implement the workflow framework</h1>


<div hidden="" id="module-unit-notification-container"></div>
<p>A workflow is a system or business process that defines how a document flows through a system by showing who must complete a task, make a decision, or approve a document. You can configure workflows in the applicable system or create them in a development environment.</p>
<p>In this unit, you learn how to create a flow and its elements from a development environment. Workflow elements include:</p>
<ul>
<li>Workflow categories</li>
<li>Workflow approvals</li>
<li>Workflow manual and automated tasks</li>
<li>Workflow types</li>
<li>Flow-control elements</li>
<li>Providers</li>
</ul>
<h2 id="create-required-elements-for-a-new-workflow-type">Create required elements for a new workflow type</h2>
<p>In Microsoft Visual Studio, you use a wizard to create a workflow type and subsequent workflow configurations. First, you must create several elements for which the workflow type wizard prompts you, including:</p>
<ul>
<li><strong>Workflow category</strong> - Specifies the workflow’s module.</li>
<li><strong>Query</strong> - Queries the document table.</li>
<li><strong>Document menu item</strong> - Points to a form, which means that you must have a table and form already created.</li>
</ul>
<p>To create the workflow category, query, and document menu item, follow these steps:</p>
<ol>
<li><p>In Solution Explorer, specify a project for the workflow development by right-clicking the solution to open the context menu and then selecting <strong>Add &gt; New project</strong>.</p>
</li>
<li><p>Enter <strong>MyWorkflow</strong> as the name for the project.</p>
<div class="NOTE">
<p>Note</p>
<p>You should have previously created a solution for use in this step.</p>
</div>
</li>
<li><p>On the properties for the project, select <strong>True</strong> for <strong>Synchronize Database</strong> because you're adding a new table to the project.</p>
</li>
<li><p>Right-click the project to open the context menu, and then select <strong>Add &gt; New Item</strong>.</p>
</li>
<li><p>Go to <strong>Dynamics 365 Items &gt; Business Process and Workflow</strong>.</p>
</li>
<li><p>Select <strong>workflow category</strong>, and then enter <strong>MyWorkflowCategory</strong> in the <strong>Name</strong> field.</p>
</li>
<li><p>Open the created workflow category in Visual Studio Designer, and then in <strong>Properties</strong>, set the module to <strong>Inventory</strong> and enter <strong>My workflow category</strong> for the label.</p>
</li>
<li><p>Create a base enumerator to manage the workflow’s status by right-clicking the project to open the context menu and then selecting <strong>Add &gt; New Item</strong>.</p>
</li>
<li><p>Select <strong>Data Types</strong> and then select <strong>Base Enum</strong>.</p>
</li>
<li><p>In the <strong>Name</strong> field, enter <strong>MyWorkflowStatus</strong> and then select <strong>Add</strong>. Right-click the new base enumerator to open the context menu and then select <strong>New Element</strong>.</p>
</li>
<li><p>Add the following seven new elements to the <strong>Base Enum</strong> (we recommend that you set the name and label):</p>
<ul>
<li>Submit</li>
<li>Started</li>
<li>Canceled</li>
<li>Complete</li>
<li>Denied (for approval workflow)</li>
<li>Change requested (for approval workflow)</li>
<li>Returned (for approval workflow)</li>
</ul>
</li>
<li><p>Create a table that includes the workflow status by right-clicking the project to open the context menu, selecting <strong>Add &gt; Table</strong>, and then entering <strong>MyWorkflowTable</strong> as the name.</p>
</li>
<li><p>Add the following extended data types to the <strong>Field</strong> node:</p>
<ul>
<li>Num</li>
<li>Description</li>
<li>MyWorkflowStatus (the newly created base enum for statuses) - Change the <strong>Allow Edit</strong> property to <strong>No</strong>.</li>
</ul>
</li>
<li><p>Select <strong>Save</strong>.</p>
</li>
<li><p>Right-click the project to open the context menu, select <strong>Add &gt; Form</strong>, and then enter the name <strong>MyWorkflowTableForm</strong>. The created form is now in Visual Studio Designer.</p>
</li>
<li><p>Drag your workflow table (MyWorkflowTable) into the <strong>Data Sources</strong> node on the form.</p>
</li>
<li><p>Right-click the form in the design area to open the context menu, and then select <strong>Apply Pattern &gt; Custom</strong>.</p>
</li>
<li><p>Right-click the form in the design area to open the context menu, and then select <strong>New &gt; Action Pane</strong>.</p>
</li>
<li><p>Right click the form in the design area to open the context menu, and then select <strong>New &gt; Grid</strong>.</p>
</li>
<li><p>Open the <strong>Data Sources</strong> node, select your data source (<strong>MyWorkflowTable</strong>), and then select <strong>Fields</strong>. Select and drag the <strong>Num</strong>, <strong>Description</strong>, and <strong>MyWorkflowStatus</strong> fields from the <strong>Fields</strong> node into the grid in the design area. Select <strong>Save</strong>.</p>
</li>
<li><p>Right-click the project to open the context menu, and then select <strong>Add &gt; New Item</strong>. Go to the user interface and select <strong>Display Menu Item</strong>.</p>
</li>
<li><p>Enter a name, such as <strong>MyWorkflowTableForm</strong>. You use this display menu item for the <strong>Workflow</strong> type and to add the form to a menu.</p>
</li>
<li><p>On the properties for the new <strong>Display Menu Item</strong>, select an <strong>Object</strong> of <strong>MyWorkflowTableForm</strong>.</p>
</li>
<li><p>Enter a label for the menu item, such as <strong>My workflow</strong>, and then select <strong>Save</strong>.</p>
</li>
<li><p>In Application Explorer, search for the <strong>InventoryManagement</strong> menu under <strong>User Interface</strong>, and then right-click the menu and select <strong>Create Extension</strong>. (Your solution should reference ApplicationSuite.) The system creates a menu extension in your project.</p>
</li>
<li><p>Right-click the menu extension in Solution Explorer, and then select <strong>Open</strong>. The menu extension opens in Designer.</p>
</li>
<li><p>Go to the <strong>InquiriesAndReports</strong> node. Select and drag the display menu item from the project to the <strong>InquiriesAndReports</strong> node in the menu extension. Select <strong>Save</strong>.</p>
</li>
<li><p>Right-click the project to open the context menu, and then select <strong>Add &gt; New Item</strong>. Go to <strong>Data Model</strong> and select <strong>Query</strong>. Enter the name <strong>MyWorkflowTableQuery</strong>.</p>
</li>
<li><p>Select and drag the table (<strong>MyWorkflowTable</strong>) from the project into the <strong>Data Source</strong> node on the query.</p>
</li>
<li><p>In the properties for the <strong>MyWorkflowTable</strong> data source, in the <strong>Dynamic Fields</strong> property, select <strong>Yes</strong> and then select <strong>Save</strong>.</p>
</li>
</ol>
<p>You’ve now created all required elements for creating a workflow type.</p>
<h2 id="create-a-workflow-type">Create a workflow type</h2>
<p>After creating all required elements for creating a workflow type, you can create a workflow type.</p>
<ol>
<li><p>Right-click the project to open the context menu, and then select <strong>Add &gt; New Item</strong>. Go to <strong>Business Process</strong> and <strong>Workflow</strong>.</p>
</li>
<li><p>Select <strong>Workflow Type</strong>, and then enter the name <strong>MyWorkflowType</strong>. The <strong>Workflow Type</strong> wizard opens.</p>
</li>
<li><p>Enter your newly created workflow category, query, and display menu items in the fields of the same names, and then select <strong>Next</strong>:</p>
<ul>
<li><p><strong>Category</strong> - MyWorkflowCategory</p>
</li>
<li><p><strong>Query</strong> - MyWorkflowTableQuery</p>
</li>
<li><p><strong>Document menu item</strong> - MyWorkflowTableForm</p>
<div class="mx-imgBorder">
</div>
</li>
</ul>
<blockquote>
<p><a data-linktype="relative-path" href="media/add-workflow-type.png#lightbox"><img alt="Screenshot of the Workflow Type page, showing the fields to fill out." data-linktype="relative-path" src="https://learn.microsoft.com/en-us/training/modules/explore-extensions-framework-finance-operations/media/add-workflow-type.png"/></a></p>
</blockquote>
</li>
<li><p>The <strong>Preview</strong> window lists the workflow type artifacts (classes and menu items). Select <strong>Next</strong> to create the workflow type and artifacts. The <strong>Add New Items</strong> window opens again, and you can close it by selecting <strong>Cancel</strong>. Several new elements should now be added to your project.</p>
</li>
<li><p>Open the two new <strong>Action Menu</strong> items and change the following labels:</p>
<ul>
<li><strong>CancelMenuItem</strong> - Change the label to <strong>Cancel</strong>.</li>
<li><strong>SubmitMenuItem</strong> - Change the label to <strong>Submit</strong>.</li>
</ul>
</li>
<li><p>Select <strong>Save All</strong>.</p>
</li>
<li><p>Open the <strong>SubmitManager</strong> class (<strong>MyWorkflowSubmitManager</strong>), and then replace the existing code with the following code. A dialog opens when you run the code. When you close the dialog, the new table’s status should change to <strong>Submit</strong>.</p>
<pre><code class="lang-xpp"> /// &lt;summary&gt;
 /// The MyWorkflowTypeSubmitManager menu item action event handler.
 /// &lt;/summary&gt;
 public class MyWorkflowTypeSubmitManager 
 {
     public static void main(Args args)
 	{
 		//  TODO:  Write code to execute once a work item is submitted.

         MyWorkflowTable         myWorkflowTable;

         WorkflowComment         note = "";
         WorkflowSubmitDialog    workflowSubmitDialog;
         WorkflowCorrelationId   workflowCorrelationId;
         WorkflowTypeName        workflowTypeName = workFlowTypeStr('MyWorkflowType');

         // Use WorkflowSubmitDialog to create a dialog.

         workflowSubmitDialog =    WorkflowSubmitDialog::construct(args.caller().getActiveWorkflowConfiguration());
         workflowSubmitDialog.run();

         if (workflowSubmitDialog.parmIsClosedOK())
         {
             myWorkflowTable = args.record();

             note = workflowSubmitDialog.parmWorkflowComment();

             try
             {
                 ttsbegin;

                 workflowCorrelationId = Workflow::activateFromWorkflowType(workflowTypeName, myWorkflowTable.RecId, note, NoYes::No);

                 myWorkflowTable.MyWorkflowStatus = MyWorkflowStatus::Submit;
                 myWorkflowTable.update();

                 ttscommit;

                 info("Workflow submitted.");
             }

             catch (Exception::Error)
             {
                 error("Workflow error.");
             }
         }

         args.caller().updateWorkFlowControls();
 	}
 }
</code></pre>
<p>You can set each status in the workflow event handler class by using a method for updating the <strong>Status</strong> field on the table that you previously created.</p>
</li>
<li><p>Open the workflow table (<strong>MyWorkflowTable</strong>) in Visual Studio Designer, and then right-click it to open the context menu. To open the code editor, select <strong>View Code</strong>.</p>
</li>
<li><p>Create a new <code>public</code> method for updating the status for a specific <strong>RecId</strong>, as follows:</p>
<pre><code class="lang-xpp"> public class MyWorkflowTable extends common
 {
     public static void  updateWorkflowStatus(RefRecId _recId , MyWorkflowStatus _status)
     {
         MyWorkflowTable    myWorkflowTable;

         ttsbegin;

         select forupdate myWorkflowTable
             where myWorkflowTable.RecId == _recId;

         if (myWorkflowTable)
         {
             myWorkflowTable.MyWorkflowStatus = _status;
             myWorkflowTable.update();
         }

         ttscommit;
     }
 }
</code></pre>
</li>
<li><p>Go to the workflow table (<strong>MyWorkflowTable</strong>), and then right-click the <strong>Methods</strong> node to open the context menu.</p>
</li>
<li><p>Select <strong>Override</strong>, and then select the <code>canSubmitToWorkflow</code> method. The method should return a status of <strong>True</strong> so that you can submit the workflow. The system should now allow you to submit all incomplete workflows.</p>
<pre><code class="lang-xpp">     /// &lt;summary&gt;
     /// Can workflow be submitted.
     /// &lt;/summary&gt;
     /// &lt;param name = "_workflowType"&gt;&lt;/param&gt;
     /// &lt;returns&gt;&lt;/returns&gt;
     public boolean canSubmitToWorkflow(str _workflowType = '')
     {
         boolean ret;

         ret = super(_workflowType);

         if (this.MyWorkflowStatus != MyWorkflowStatus::Complete)
         {
             ret = true;
         }
         else
         {
             ret = false;
         }

         return ret;
     }
</code></pre>
</li>
<li><p>Select <strong>Save all</strong> and then build the project.</p>
</li>
<li><p>Open the <code>event handler</code> class for the workflow type (<strong>MyWorkflowTypeEventHandler</strong>). The class has event methods for started, canceled, and completed. Call the method for updating the status on the table, as follows:</p>
<pre><code class="lang-xpp"> /// &lt;summary&gt;
 /// The MyWorkflowTypeEventHandler workflow event handler.
 /// &lt;/summary&gt;
 public class  MyWorkflowTypeEventHandler implements WorkflowCanceledEventHandler,  
 	WorkflowCompletedEventHandler,
 	WorkflowStartedEventHandler
 {
     public void started(WorkflowEventArgs _workflowEventArgs)
 	{
 		// TODO:  Write code to execute once the workflow is started.

         MyWorkflowTable::updateWorkflowStatus(_workflowEventArgs.parmWorkflowContext().parmRecId(),MyWorkflowStatus::Submit);
 	}

     public void canceled(WorkflowEventArgs _workflowEventArgs)
 	{
 		// TODO:  Write code to execute once the workflow is canceled.

         MyWorkflowTable::updateWorkflowStatus(_workflowEventArgs.parmWorkflowContext().parmRecId(),MyWorkflowStatus::Canceled);
 	}

     public void completed(WorkflowEventArgs _workflowEventArgs)
 	{
 		// TODO:  Write code to execute once the workflow is completed.

         MyWorkflowTable::updateWorkflowStatus(_workflowEventArgs.parmWorkflowContext().parmRecId(),MyWorkflowStatus::Complete);
 	}
 }
</code></pre>
</li>
<li><p>Select <strong>Save all</strong> and then build the project again.</p>
</li>
<li><p>The system creates the workflow type. To set workflow properties, open <strong>MyWorkflowTableForm</strong>.</p>
</li>
<li><p>In <strong>FormDesign</strong> properties, locate and fill out the following elements:</p>
<ul>
<li><strong>Title Data Source</strong> - MyWorkflowTable</li>
<li><strong>Workflow Data Source</strong> - MyWorkflowTable</li>
<li><strong>Workflow enabled</strong> - Yes</li>
<li><strong>Workflow Type</strong> - MyWorkflowType</li>
</ul>
</li>
<li><p>Select <strong>Save all</strong> and then build the project again with synchronization turned on.</p>
</li>
</ol>
<p>Your workflow type is now created.</p>
<h2 id="create-workflow-approval">Create workflow approval</h2>
<p>After you create the workflow type, you can create workflow approval. To do so, make sure that you have the following prerequisites:</p>
<ul>
<li><strong>Document type</strong> - The workflow type creates the document type class.</li>
<li><strong>Document preview field group</strong> - You must create a new field group on the table, which the following process explains how to complete.</li>
<li><strong>Document menu item</strong> - You previously created this component.</li>
</ul>
<h3 id="add-the-preview-field-group-to-the-table">Add the preview field group to the table</h3>
<p>To add the preview field group to the table, follow these steps:</p>
<ol>
<li>Open the <strong>MyWorkflowTable</strong> table in Visual Studio Designer, and then go to the field groups.</li>
<li>Right-click the <strong>Field groups</strong> node to open the context menu, and then add a new group named <strong>Workflow</strong>.</li>
<li>Move your three fields from the table into the field group.</li>
<li>Select <strong>Save all</strong> and then build the project.</li>
</ol>
<p>Now, you can create the workflow approval.</p>
<h3 id="create-the-new-workflow-approval">Create the new workflow approval</h3>
<p>To create the workflow approval, follow these steps:</p>
<ol>
<li><p>Right-click the project to open the context menu, and then select <strong>Add New Item</strong>.</p>
</li>
<li><p>Go to <strong>Business Process and Workflow</strong>, select <strong>Workflow Approval</strong>, and then enter the name <strong>MyWorkflowApproval</strong>.</p>
</li>
<li><p>Enter the following settings in the Workflow Approval wizard that opens:</p>
<ul>
<li><strong>Workflow document</strong> - The document that you created (MyWorkflowTypeDocument) when creating the workflow type.</li>
<li><strong>Document preview field group</strong> - The field group (Workflow) that you created.</li>
<li><strong>Document menu item</strong> - The menu item that you created for your form and used in the workflow type (MyWorkflowTableForm).</li>
<li><strong>Enable Deny outcome</strong> - Leave the field as it is.</li>
</ul>
</li>
<li><p>Select <strong>Next</strong>. The <strong>Workflow Approval</strong> page should appear.</p>
<div class="mx-imgBorder">
<p><a data-linktype="relative-path" href="media/workflow-approval.png#lightbox"><img alt="Screenshot of the Workflow Approval page, showing the result of the steps." data-linktype="relative-path" src="https://learn.microsoft.com/en-us/training/modules/explore-extensions-framework-finance-operations/media/workflow-approval.png"/></a></p>
</div>
</li>
<li><p>Select <strong>Next</strong> to have the system create all classes and menu items or select <strong>Cancel</strong> to close the window. The system adds the classes and menu items to your project, but you must modify it.</p>
</li>
<li><p>Open your workflow approval event handler class from the project <strong>MyWorkflowEventHandler</strong>.</p>
</li>
<li><p>For each status, update your table. The following code example calls the <code>updateWorkflowStatus</code> method for each event to update its status in the table.</p>
<pre><code class="lang-xpp">    public void started(WorkflowElementEventArgs _workflowElementEventArgs)
 	{
 		// TODO:  Write code to execute once the workflow is started.

         MyWorkflowTable::updateWorkflowStatus(_workflowElementEventArgs.parmWorkflowContext().parmRecId(),MyWorkflowStatus::Started);
 	}

    public void canceled(WorkflowElementEventArgs _workflowElementEventArgs)
 	{
 		// TODO:  Write code to execute once the workflow is canceled.

         MyWorkflowTable::updateWorkflowStatus(_workflowElementEventArgs.parmWorkflowContext().parmRecId(),MyWorkflowStatus::Canceled);
 	}

    public void completed(WorkflowElementEventArgs _workflowElementEventArgs)
 	{
 		// TODO:  Write code to execute once the workflow is completed.

         MyWorkflowTable::updateWorkflowStatus(_workflowElementEventArgs.parmWorkflowContext().parmRecId(),MyWorkflowStatus::Complete);
 	}

    public void denied(WorkflowElementEventArgs _workflowElementEventArgs)
 	{
 		// TODO:  Write code to execute once the workflow is denied.

         MyWorkflowTable::updateWorkflowStatus(_workflowElementEventArgs.parmWorkflowContext().parmRecId(),MyWorkflowStatus::Denied);
 	}

    public void changeRequested(WorkflowElementEventArgs _workflowElementEventArgs)
 	{
 		// TODO:  Write code to execute once change is requested for the workflow.

         MyWorkflowTable::updateWorkflowStatus(_workflowElementEventArgs.parmWorkflowContext().parmRecId(),MyWorkflowStatus::ChangeRequested);
 	}

    public void returned(WorkflowElementEventArgs _workflowElementEventArgs)
 	{
 		// TODO:  Write code to execute once the workflow is returned.

         MyWorkflowTable::updateWorkflowStatus(_workflowElementEventArgs.parmWorkflowContext().parmRecId(),MyWorkflowStatus::Returned);
 	}

    public void created(WorkflowWorkItemsEventArgs _workflowWorkItemsEventArgs)
 	{
 		// TODO:  Write code to execute once work items are created.
 	}
</code></pre>
</li>
<li><p>Select <strong>Save all</strong>.</p>
</li>
<li><p>For the workflow approval action menu items, you must set labels:</p>
<ol>
<li>Open the Action Menu Item for the <strong>Approve</strong> workflow approval (<strong>MyWorkflowApprovalApprove</strong>) in Visual Studio Designer, and then set the <strong>Label</strong> property to <strong>Approve</strong>.</li>
<li>Select <strong>Save all</strong> and then close the menu item.</li>
<li>Open the Action Menu Item for the <strong>Delegate</strong> workflow approval (<strong>MyWorkflowApprovalDelegateMenuItem</strong>), and then set the <strong>Label</strong> property to <strong>Delegate</strong>.</li>
<li>Select <strong>Save all</strong> and then close the menu item.</li>
<li>Open the Action Menu Item for the <strong>Reject</strong> workflow approval (<strong>MyWorkflowApprovalReject</strong>), and then set the <strong>Label</strong> property to <strong>Reject</strong>.</li>
<li>Select <strong>Save all</strong> and then close the menu item.</li>
<li>Open the Action Menu Item for the <strong>Request</strong> change workflow approval (<strong>MyWorkflowApprovalRequestChange</strong>), and then set the <strong>Label</strong> property to <strong>Request</strong> change.</li>
<li>Select <strong>Save all</strong> and then close the menu item.</li>
<li>Open the Action Menu Item for the <strong>Re-submit</strong> workflow approval (<strong>MyWorkflowApprovalResubmit</strong>), and then set the <strong>Label</strong> property to <strong>Re-submit</strong>.</li>
<li>Select <strong>Save all</strong> and then close the menu item.</li>
</ol>
</li>
<li><p>Point the workflow type to workflow approval by opening the workflow type (<strong>MyWorkflowType</strong>) in Visual Studio Designer. Go to and right-click <strong>Supported Elements</strong> to open the context menu, and then select <strong>New Workflow Element Reference</strong>.</p>
</li>
<li><p>In the <strong>Properties</strong> window, enter your workflow approval name (<strong>MyWorkflowApproval</strong>) in the <strong>Element Name</strong> and <strong>Name</strong> fields.</p>
</li>
<li><p>Go to the top node for <strong>MyWorkflowType</strong>, and in the <strong>Properties</strong> window, change the label to <strong>My workflow type</strong>.</p>
</li>
<li><p>Select <strong>Save all</strong> and then build the project with synchronize.</p>
</li>
</ol>
<p>You’ve now completed all workflow development.</p>
<h2 id="test-a-created-workflow">Test a created workflow</h2>
<p>To test a workflow in finance and operations apps, you must first activate it.</p>
<p>Your newly created workflow belongs to the Inventory module. In <strong>Inventory Management &gt; Setup &gt; Inventory management workflows</strong>, set up your newly developed workflow:</p>
<ol>
<li>Select <strong>New</strong>. A window opens that lists all workflows for the module.</li>
<li>Select your workflow type (<strong>My workflow type</strong>). In the dialog that appears, select <strong>Open</strong>. Run the application.</li>
<li>Enter the applicable username and password for authentication. A new application should open. Typically, your workflow designer appears beneath the new application, so make sure that you watch your taskbar. Select the workflow designer to configure the workflow.</li>
<li>Select <strong>Basic Settings</strong> to enter a placeholder of <strong>My workflow</strong>, and then close <strong>Basic Settings</strong>.</li>
<li>Select and drag the <strong>MyWorkflowApproval</strong> into the workflow under <strong>Start</strong>.</li>
<li>Connect <strong>Start</strong> to <strong>MyWorkflowApproval</strong> and <strong>MyWorkflowApproval</strong> to <strong>End</strong>.</li>
<li>Double-click <strong>MyWorkflowApproval</strong> to go to the next level, where you configure the basic settings.</li>
<li>Select <strong>Step 1</strong>, and then configure the <strong>Basic Settings</strong> by entering text and instructions.</li>
<li>Select <strong>Assignments</strong> for the user assignment, and then select <strong>User</strong> to go to the <strong>User</strong> tab.</li>
<li>Select <strong>Admin</strong> as the user, and then select <strong>Close</strong>.
<div class="mx-imgBorder">
<p><a data-linktype="relative-path" href="media/my-workflow-type.png#lightbox"><img alt="Screenshot of the Workflow design." data-linktype="relative-path" src="https://learn.microsoft.com/en-us/training/modules/explore-extensions-framework-finance-operations/media/my-workflow-type.png"/></a></p>
</div>
</li>
<li>Select <strong>Save and close</strong> (shrink the window so you can find it in the lower part), and then enter <strong>Version notes</strong>.</li>
<li>Select <strong>Activate the new version</strong>, and in <strong>Inventory management workflows</strong>, find your workflow.</li>
<li>Under <strong>Manage</strong>, select <strong>Versions</strong>.</li>
<li>Verify that your workflow is active. If it’s not, select <strong>Active</strong> to activate it. Finance and operations apps should show your workflow as activated, and a new action should appear in the form
<div class="mx-imgBorder">
<p><a data-linktype="relative-path" href="media/view-workflow-form.png#lightbox"><img alt="Screenshot of the MyWorkflowTableForm." data-linktype="relative-path" src="https://learn.microsoft.com/en-us/training/modules/explore-extensions-framework-finance-operations/media/view-workflow-form.png"/></a></p>
</div>
</li>
</ol>
<p>Your workflow is now in use in finance and operations apps.</p>
<div class="modular-content-container" hidden="" id="next-section">
</div>
</div>
<div class="section is-uniform position-relative" id="unit-inner-section">
<h1 class="margin-right-xxl-desktop" id="module-unit-title">Lab - Extend an EDT</h1>


<div hidden="" id="module-unit-notification-container"></div>
<h2 id="read-this-first---before-you-start-the-lab">Read this first - before you start the lab!</h2>
<div class="IMPORTANT">
<p>Important</p>
<p>For this lab, you CAN'T sign in with your own credentials. Use the following steps to sign in to your lab environment with the correct credentials.</p>
</div>
<ol>
<li>Ensure that you're signed in to Microsoft Learn.</li>
<li>Select <strong>Launch VM mode</strong> or <strong>Sign in to launch VM mode</strong> in this unit.</li>
<li>In the <strong>Resources</strong> tab on the lab side bar, select the <strong>T</strong> icon next to <strong>Password</strong> in the <strong>Finance and Operations</strong> box, to have the administrator password for the Virtual Machine (VM) entered for you.</li>
<li>Select <strong>Enter</strong>.</li>
<li>Microsoft Edge opens. Wait for it to navigate to the <strong>Sign in</strong> page for finance and operations. If you experience an issue with the <strong>Sign in</strong> page loading, try to restart the browser in the VM.</li>
<li>On the Microsoft <strong>Sign in</strong> page in finance and operations, place your mouse cursor into the <strong>Username</strong> field.</li>
<li>On the <strong>Resources</strong> tab of the lab side bar, below the <strong>Azure portal</strong> heading, select the <strong>T</strong> icon next to <strong>Username</strong>, then press <strong>Enter</strong>.</li>
<li>Your mouse cursor is now in the <strong>Password</strong> page.</li>
<li>On the <strong>Resources</strong> tab of the lab side bar, below the <strong>Azure portal</strong> heading, select the <strong>T</strong> icon next to select <strong>Password</strong>, then press <strong>Enter</strong>.</li>
<li>In the <strong>Save password</strong> window, select <strong>Never</strong>.</li>
<li>Select <strong>Accept</strong> in the <strong>Permissions requested</strong> page.</li>
<li>To see the lab instructions, select the <strong>Instructions</strong> tab on the lab side bar.</li>
</ol>
<p>You can now begin your work on this lab.</p>
<h2 id="scenario">Scenario</h2>
<p>The finance and operations apps developer has been asked by the Fleet
Management company to change a number-entry field on the <strong>Customer</strong> page. The <strong>Agency location code</strong> field only accepts 12 digits, and the company needs to be able to enter 14 digits. Because the company doesn't need a new field, the developer will create an extension of the <code>AgencyLocationCode</code> EDT in Visual Studio.</p>
<h2 id="create-a-new-project">Create a new project</h2>
<ol>
<li>Close the Microsoft Edge window and finance and operations.</li>
<li>Right-click the <strong>Visual Studio</strong> icon on the desktop, and select <strong>Run as administrator</strong>.</li>
<li>Select <strong>Continue without code</strong> at the bottom of the page to open Visual studio.</li>
<li>To ensure the correct applications suite is referenced, select <strong>Extensions</strong> in the toolbar, and then select <strong>Dynamics 365</strong> &gt; <strong>Model Management &gt; Update model parameters</strong>.</li>
<li>Select the <strong>FleetManagement</strong> model from the <strong>Model name</strong> drop-down list.</li>
<li>Select <strong>Next</strong>, then ensure <strong>ApplicationSuite</strong> is selected in the <strong>Select referenced packages</strong> drop-down list. Leave any other selections as is.</li>
<li>Select <strong>Next</strong> three times.</li>
<li>Open the <strong>File</strong> menu and select <strong>New &gt; Project</strong>.</li>
<li>Search for <strong>Finance Operations</strong> if it is not already showing in the latest projects list, and then select <strong>Next</strong>.</li>
<li>In the <strong>Configure your new project</strong> dialog box enter <strong>FleetManagementExtensionProject</strong> in the <strong>Project name</strong> field.</li>
<li>Select <strong>Create</strong>.</li>
<li>Select <strong>Dynamics 365</strong> &gt; <strong>Options</strong> in the <strong>Extensions</strong> menu at the top of the page.</li>
<li>Under the <strong>Dynamics 365</strong> node on the left pane, select
<strong>Projects</strong>.</li>
<li>Ensure the check boxes for <strong>Organize projects by element type</strong> and <strong>Synchronize database on build for newly created project</strong> are selected. If others are selected, just leave them as is.</li>
<li>Select <strong>OK</strong>.</li>
</ol>
<h2 id="extend-the-agencylocationcode-edt">Extend the AgencyLocationCode EDT</h2>
<ol>
<li><p>Select <strong>View</strong> &gt; <strong>Application Explorer</strong> in the ribbon to open the Application Explorer.</p>
</li>
<li><p>In the search bar, in the <strong>Application Explorer</strong> window, expand the <strong>AOT</strong> node and then expand the <strong>Data Types</strong> node.</p>
</li>
<li><p>In the <strong>Data types</strong> node, expand the <strong>Extended Data Types</strong> node.</p>
</li>
<li><p>Select the <strong>AgencyLocationCode</strong> EDT.</p>
</li>
<li><p>Right-click the <strong>AgencyLocationCode</strong> EDT and select <strong>Create extension</strong>. An element named <strong>AgencyLocationCode.FleetManagement</strong> will be added to your <strong>FleetManagementExtensionProject</strong> in Solution Explorer.  For demonstration purposes, you will keep the default name.</p>
<div class="NOTE">
<p>Note</p>
<p>We recommend that you rename the extension to avoid conflict with any extensions that are rolled out during application updates. For example, you should rename <strong>AgencyLocationCode.Extension</strong> to
<strong>AgencyLocationCode.abcExtension</strong>.</p>
</div>
</li>
<li><p>Double-click the <strong>AgencyLocationCode.FleetManagement</strong> element in the  <strong>Solution Explorer</strong> window to open it in the element designer window in the middle of the page.</p>
</li>
<li><p>Right-click the <strong>AgencyLocationCode.FleetManagement</strong> main node in the element designer window in the middle of the page, and select <strong>Properties</strong>.</p>
</li>
<li><p>Change the <strong>String size</strong> property to  <strong>14</strong>.</p>
</li>
<li><p>Perform a build by right-clicking the project   <strong>FleetManagementExtensionProject</strong> in the <strong>Solution Explorer</strong> window   and then selecting <strong>Build</strong>.</p>
</li>
</ol>
<h2 id="close-the-lab-environment">Close the lab environment</h2>
<ol>
<li>Select <strong>Done</strong> in the <strong>Instructions</strong> pane in the lab side bar.</li>
<li>In the <strong>Lab is complete</strong> window, select <strong>Continue</strong>, and then select <strong>Leave</strong> to return to the next unit in the module.</li>
</ol>
<div class="modular-content-container" hidden="" id="next-section">
</div>
</div>
<div class="section is-uniform position-relative" id="unit-inner-section">
<h1 class="margin-right-xxl-desktop" id="module-unit-title">Check your knowledge</h1>


<div hidden="" id="module-unit-notification-container"></div>
<h2>Answer the following questions to see what you learned</h2>
<form aria-label="Knowledge check" class="quiz-form margin-top-xs" data-bi-name="quiz" role="form">
<fieldset class="field">
<div role="list">
<div class="quiz-question" data-bi-name="question" role="listitem">
<div aria-labelledby="quiz-question-1" class="quiz-question-title font-size-md margin-top-sm margin-bottom-xs" role="radiogroup">
<div class="margin-top-sm margin-bottom-xs field-label" id="quiz-question-1">
<span class="font-weight-semibold">1.</span>
<p>Creating extensions is the method used to make customizations in finance and operations apps. Which of the following is a benefit of using extensions instead of overlaying?</p>
<span class="required-indicator"></span>
</div>
<div class="field-body">
<label class="quiz-choice display-flex padding-block-xxs padding-inline-xs margin-bottom-xxs radio" for="quiz-choice-0-0">
<input class="radio-dot choice-input" id="quiz-choice-0-0" name="0" type="radio" value="0"/>
<div class="margin-inline-sm radio-label-text">
<p>Extensions take less time to create.</p>
</div>
</label>
<div class="quiz-choice-explanation margin-block-xxs font-weight-semibold margin-left-lg">
</div>
<label class="quiz-choice display-flex padding-block-xxs padding-inline-xs margin-bottom-xxs radio" for="quiz-choice-0-1">
<input class="radio-dot choice-input" id="quiz-choice-0-1" name="0" type="radio" value="1"/>
<div class="margin-inline-sm radio-label-text">
<p>Build times are reduced with extensions.</p>
</div>
</label>
<div class="quiz-choice-explanation margin-block-xxs font-weight-semibold margin-left-lg">
</div>
<label class="quiz-choice display-flex padding-block-xxs padding-inline-xs margin-bottom-xxs radio" for="quiz-choice-0-2">
<input class="radio-dot choice-input" id="quiz-choice-0-2" name="0" type="radio" value="2"/>
<div class="margin-inline-sm radio-label-text">
<p>Updates are rolled out less frequently by using extensions.</p>
</div>
</label>
<div class="quiz-choice-explanation margin-block-xxs font-weight-semibold margin-left-lg">
</div>
<label class="quiz-choice display-flex padding-block-xxs padding-inline-xs margin-bottom-xxs radio" for="quiz-choice-0-3">
<input class="radio-dot choice-input" id="quiz-choice-0-3" name="0" type="radio" value="3"/>
<div class="margin-inline-sm radio-label-text">
<p>Extensions cost more to maintain than overlaying.</p>
</div>
</label>
<div class="quiz-choice-explanation margin-block-xxs font-weight-semibold margin-left-lg">
</div>
</div>
</div>
</div>
<div class="quiz-question" data-bi-name="question" role="listitem">
<div aria-labelledby="quiz-question-2" class="quiz-question-title font-size-md margin-top-sm margin-bottom-xs" role="radiogroup">
<div class="margin-top-sm margin-bottom-xs field-label" id="quiz-question-2">
<span class="font-weight-semibold">2.</span>
<p>Which of the following statements is true regarding extending enums in Visual Studio?</p>
<span class="required-indicator"></span>
</div>
<div class="field-body">
<label class="quiz-choice display-flex padding-block-xxs padding-inline-xs margin-bottom-xxs radio" for="quiz-choice-1-0">
<input class="radio-dot choice-input" id="quiz-choice-1-0" name="1" type="radio" value="0"/>
<div class="margin-inline-sm radio-label-text">
<p>Enums, where the IsExtensible property is set to True, can be extended.</p>
</div>
</label>
<div class="quiz-choice-explanation margin-block-xxs font-weight-semibold margin-left-lg">
</div>
<label class="quiz-choice display-flex padding-block-xxs padding-inline-xs margin-bottom-xxs radio" for="quiz-choice-1-1">
<input class="radio-dot choice-input" id="quiz-choice-1-1" name="1" type="radio" value="1"/>
<div class="margin-inline-sm radio-label-text">
<p>Any enum in Visual Studio can be extended.</p>
</div>
</label>
<div class="quiz-choice-explanation margin-block-xxs font-weight-semibold margin-left-lg">
</div>
<label class="quiz-choice display-flex padding-block-xxs padding-inline-xs margin-bottom-xxs radio" for="quiz-choice-1-2">
<input class="radio-dot choice-input" id="quiz-choice-1-2" name="1" type="radio" value="2"/>
<div class="margin-inline-sm radio-label-text">
<p>Only enums that are contained in the Application Suite model can be extended.</p>
</div>
</label>
<div class="quiz-choice-explanation margin-block-xxs font-weight-semibold margin-left-lg">
</div>
<label class="quiz-choice display-flex padding-block-xxs padding-inline-xs margin-bottom-xxs radio" for="quiz-choice-1-3">
<input class="radio-dot choice-input" id="quiz-choice-1-3" name="1" type="radio" value="3"/>
<div class="margin-inline-sm radio-label-text">
<p>Enums, where the IsExtensible property is set to False, can be extended.</p>
</div>
</label>
<div class="quiz-choice-explanation margin-block-xxs font-weight-semibold margin-left-lg">
</div>
</div>
</div>
</div>
<div class="quiz-question" data-bi-name="question" role="listitem">
<div aria-labelledby="quiz-question-3" class="quiz-question-title font-size-md margin-top-sm margin-bottom-xs" role="radiogroup">
<div class="margin-top-sm margin-bottom-xs field-label" id="quiz-question-3">
<span class="font-weight-semibold">3.</span>
<p>You want to create an extension from an element in the AOT. What must you verify to create this extension?</p>
<span class="required-indicator"></span>
</div>
<div class="field-body">
<label class="quiz-choice display-flex padding-block-xxs padding-inline-xs margin-bottom-xxs radio" for="quiz-choice-2-0">
<input class="radio-dot choice-input" id="quiz-choice-2-0" name="2" type="radio" value="0"/>
<div class="margin-inline-sm radio-label-text">
<p>Ensure that the Sync database on build property is set to True.</p>
</div>
</label>
<div class="quiz-choice-explanation margin-block-xxs font-weight-semibold margin-left-lg">
</div>
<label class="quiz-choice display-flex padding-block-xxs padding-inline-xs margin-bottom-xxs radio" for="quiz-choice-2-1">
<input class="radio-dot choice-input" id="quiz-choice-2-1" name="2" type="radio" value="1"/>
<div class="margin-inline-sm radio-label-text">
<p>Check that you're referencing the model that houses the element that you want to extend.</p>
</div>
</label>
<div class="quiz-choice-explanation margin-block-xxs font-weight-semibold margin-left-lg">
</div>
<label class="quiz-choice display-flex padding-block-xxs padding-inline-xs margin-bottom-xxs radio" for="quiz-choice-2-2">
<input class="radio-dot choice-input" id="quiz-choice-2-2" name="2" type="radio" value="2"/>
<div class="margin-inline-sm radio-label-text">
<p>Incorrect. Verify that the AOT is set to Model view instead of Classic view.</p>
</div>
</label>
<div class="quiz-choice-explanation margin-block-xxs font-weight-semibold margin-left-lg">
</div>
</div>
</div>
</div>
<div class="quiz-question" data-bi-name="question" role="listitem">
<div aria-labelledby="quiz-question-4" class="quiz-question-title font-size-md margin-top-sm margin-bottom-xs" role="radiogroup">
<div class="margin-top-sm margin-bottom-xs field-label" id="quiz-question-4">
<span class="font-weight-semibold">4.</span>
<p>You create a new class by using a method. You need to protect the method from being extended by using Chain of Command (CoC). Which attribute or modifiers should you use to protect the method?</p>
<span class="required-indicator"></span>
</div>
<div class="field-body">
<label class="quiz-choice display-flex padding-block-xxs padding-inline-xs margin-bottom-xxs radio" for="quiz-choice-3-0">
<input class="radio-dot choice-input" id="quiz-choice-3-0" name="3" type="radio" value="0"/>
<div class="margin-inline-sm radio-label-text">
<p>Use ´[Hookable(false)] as a method attribute.</p>
</div>
</label>
<div class="quiz-choice-explanation margin-block-xxs font-weight-semibold margin-left-lg">
</div>
<label class="quiz-choice display-flex padding-block-xxs padding-inline-xs margin-bottom-xxs radio" for="quiz-choice-3-1">
<input class="radio-dot choice-input" id="quiz-choice-3-1" name="3" type="radio" value="1"/>
<div class="margin-inline-sm radio-label-text">
<p>Use ´[Wrappable(false)] as a method attribute.</p>
</div>
</label>
<div class="quiz-choice-explanation margin-block-xxs font-weight-semibold margin-left-lg">
</div>
<label class="quiz-choice display-flex padding-block-xxs padding-inline-xs margin-bottom-xxs radio" for="quiz-choice-3-2">
<input class="radio-dot choice-input" id="quiz-choice-3-2" name="3" type="radio" value="2"/>
<div class="margin-inline-sm radio-label-text">
<p>Use ´[Replaceable(true)] as a method attribute.</p>
</div>
</label>
<div class="quiz-choice-explanation margin-block-xxs font-weight-semibold margin-left-lg">
</div>
<label class="quiz-choice display-flex padding-block-xxs padding-inline-xs margin-bottom-xxs radio" for="quiz-choice-3-3">
<input class="radio-dot choice-input" id="quiz-choice-3-3" name="3" type="radio" value="3"/>
<div class="margin-inline-sm radio-label-text">
<p>Use a protected modifier.</p>
</div>
</label>
<div class="quiz-choice-explanation margin-block-xxs font-weight-semibold margin-left-lg">
</div>
</div>
</div>
</div>
</div>
<div class="has-loading-skeleton" id="module-unit-quiz-submit-container"></div>
<p class="font-size-sm color-danger font-weight-semibold margin-top-xxs is-hidden" id="unanswered-question-error" role="alert">You must answer all questions before checking your work.</p>
<p class="visually-hidden" id="screen-reader-text"></p>
</fieldset>
</form>
<div class="modular-content-container" hidden="" id="next-section">
</div>
</div>
<div class="section is-uniform position-relative" id="unit-inner-section">
<h1 class="margin-right-xxl-desktop" id="module-unit-title">Summary</h1>


<div hidden="" id="module-unit-notification-container"></div>
<p>Creating extensions can be a simple process to help customize the finance and operations apps user interface. Because finance and operations apps are provided as an Infrastructure as a service (IaaS) application, updates are made regularly. Overlaying base code can cause update conflicts and issues and can create extra work for developers. Extensions often save you money because you don't have to spend time fixing overlayered code that broke during an update.</p>
<p>For these reasons, overlaying is not allowed in finance and operations apps, and extensions are the preferred practice for customizations.</p>
<p>Elements within the AOT, such as EDTs, enums, tables, and forms can be extended and added to your project. You can also create an augmented class to use code to customize finance and operations apps. If creating an extension doesn't fulfill your customization needs, you can log an extensibility request with Microsoft through your project in Lifecycle Services.</p>
<h2 id="links-to-related-modules-and-sites-for-specific-topics">Links to related modules (and sites) for specific topics</h2>
<table>
<thead>
<tr>
<th>Topic</th>
<th>Link</th>
</tr>
</thead>
<tbody>
<tr>
<td>Extensibility</td>
<td><a data-linktype="absolute-path" href="/en-us/dynamics365/fin-ops-core/dev-itpro/extensibility/extensibility-home-page/?azure-portal=true">Extensibility home page</a></td>
</tr>
<tr>
<td>Submit request for new extension points</td>
<td><a data-linktype="absolute-path" href="/en-us/dynamics365/fin-ops-core/dev-itpro/extensibility/extensibility-requests/?azure-portal=true">Extensibility Requests</a></td>
</tr>
<tr>
<td>How to avoid intrusive customizations</td>
<td><a data-linktype="absolute-path" href="/en-us/dynamics365/fin-ops-core/dev-itpro/extensibility/intrusive-customizations/?azure-portal=true">Intrusive customizations</a></td>
</tr>
<tr>
<td>Extensibility roadmap</td>
<td><a data-linktype="absolute-path" href="/en-us/dynamics365/fin-ops-core/dev-itpro/extensibility/extensibility-roadmap/?azure-portal=true">Application extensibility roadmap</a></td>
</tr>
</tbody>
</table>
<p>For further information about extensions, advance to the next module in this learning path about extending elements.</p>
<div class="modular-content-container" hidden="" id="next-section">
</div>
</div>
<div class="section is-uniform position-relative" id="unit-inner-section">
<h1 class="margin-right-xxl-desktop" id="module-unit-title">Introduction</h1>


<div hidden="" id="module-unit-notification-container"></div>
<p>Development for finance and operations apps is extension-based and does not allow customizing base code and elements. This method of development for finance and operations apps allows developers to modify the application behavior and elements in a less intrusive manner. This approach enables organizations to continuously update the application with lower costs and minimum code errors.</p>
<p>An element in the Application Object Tree (AOT) can be extended and
added to your project if you are referencing the model that contains the
original element. If you right-click the element in the AOT and select
<strong>Create extension</strong>, the extended element is added to your project and
can be customized by using the designer window.</p>
<p>With extensions, you can modify existing elements, extend source code by
using class augmentation, and create event handlers.</p>
<p>Tables and forms have many components, and they can be extended to add elements, such as fields or data sources, or to add methods and event
handlers. Class extensions augment a class by adding methods and
variables to an existing table or form.</p>
<p>Watch this video to see how you can create object extensions from the AOT.</p>
<div class="embeddedvideo"><iframe allowfullscreen="true" data-linktype="external" frameborder="0" src="https://learn-video.azurefd.net/vod/player?id=0f0bf0b2-2915-4759-bb10-ddc00544d22c"></iframe></div>
<div class="modular-content-container" hidden="" id="next-section">
</div>
</div>
<div class="section is-uniform position-relative" id="unit-inner-section">
<h1 class="margin-right-xxl-desktop" id="module-unit-title">Add a table extension to a project</h1>


<div hidden="" id="module-unit-notification-container"></div>
<p>If you want to modify the fields, field groups, indexes, mappings, or
relations of a table, you can create an extension of the table and make the necessary changes. Additionally, you can add fields and add fields to field groups.</p>
<p>Fields can be added by either right-clicking the <strong>Fields</strong> node of the
table and selecting <strong>New</strong>, or by selecting and dragging a field from the AOT or <strong>Solution Explorer</strong> window to the <strong>Fields</strong> node of the
table. After the field is added to the table, you can select and drag it
to an existing field group, or you can create a new field group and drag
the field to it. The added field and/or field group will be shown in bold type, while the existing fields and field groups will be displayed in italic type.</p>
<p>The following is an example of adding the <strong><code>AccountNum</code></strong> field
from <strong>AOT &gt; Data Types &gt; Extended Data Types</strong> to the <strong>Fields</strong> node
of the <strong><code>FMCustomer.myExtension</code></strong> table.</p>
<p><img alt="This is a screenshot from Visual Studio showing the AccountNum field
has been added to an extension of the FMCustomer
table." data-linktype="relative-path" src="https://learn.microsoft.com/en-us/training/modules/extend-elements-finance-operations/media/table-extension.png"/></p>
<h2 id="table-indexes">Table indexes</h2>
<p>An <strong>index</strong> can speed up database searches. If you add fields to a table,
you might also want to add a dedicated index. You can use existing
fields and new fields in creating the index. After you have created an
extension of your desired table, you can add an index in the same manner that you would add an index to a new table. You cannot use an extension to create a unique index. That type of development is intrusive and therefore not allowed.</p>
<p>Like adding an index to a table after adding new fields, you might also need to create a relation if the new field should be linked to another table. Defining relations can help you guarantee referential integrity by describing the link between the two tables. Adding a new relation to an extended table follows the same process as adding a relation to a new table.</p>
<p>You can adjust the table's or the individual field's label or help text,
as well as other available properties. If you set the <strong>Created By</strong>,
<strong>Created Data Time</strong>, <strong>Modified By</strong>, or <strong>Modified Date Time</strong>
property to <strong>Yes</strong>, it will add corresponding tracking information
about the user to the table when records are created or updated. Not
every property that is listed in the <strong>Properties</strong> window can be
adjusted. For example, the tracking properties that were mentioned cannot be changed to <strong>No</strong> if they are set to <strong>Yes</strong> on the base table. If a property appears dimmed, it isn't editable.</p>
<h2 id="table-business-logic">Table business logic</h2>
<p>Event handlers can also be implemented and are called from the base
implementations of the table methods. First, you need to create a new class that extends the desired table and enables access to its fields and methods. The class should be decorated with the <code>final</code> and <code>[ExtensionOf()]</code> attributes and have the <code>_Extension</code> suffix. The following code sample shows how to create a new class that extends the table InventTable.</p>
<pre><code class="lang-xpp">[ExtensionOf(tableStr(InventTable))]
final class InventTableMy_Extension
{
	public void myDefaultInventLocationId()
	{
		//Contains organization-specific logic to initialize the new field here.
		this.MyInventLocationID = this.inventLocationId();
	}
}
</code></pre>
<p>Next, you will add methods to the augmented class and use your new method
from an event handler. The following is an example of an <code>InventTable</code> class event handler.</p>
<pre><code class="lang-xpp">class InventTableMy_EventHandler
{
	[DataEventHandler(tableStr(InventTable), DataEventType::Inserting)]
	public static void InventTable_onInserting(Common sender, DataEventArgs e)
	{
		InventTable inventTable = sender as InventTable;
		// Call the method as if it was defined directly on InventTable.
		inventTable.myDefaultInventLocationId();
	}
}
</code></pre>
<div class="modular-content-container" hidden="" id="next-section">
</div>
</div>
<div class="section is-uniform position-relative" id="unit-inner-section">
<h1 class="margin-right-xxl-desktop" id="module-unit-title">Add a form extension to a project</h1>


<div hidden="" id="module-unit-notification-container"></div>
<p>To add new functionality to a form, you need to create an extension of that form. Of the many reasons that you would extend a form, you can add a new control, enable or disable an existing control, or change a control's visibility. For example, you can add a new <strong>FastTab</strong> to a <strong>Details Master</strong> form or make a <strong>FastTab</strong> not visible.</p>
<p>You can modify properties for the form and its controls, such as the
<strong>Label</strong>, <strong>Caption</strong>, or <strong>Help text</strong>. Modifying the caption will change the wording of the page in the user interface on a browser's address bar. You can also add a data source or a form part.</p>
<p>You can extend a form to implement event handlers that are called from
the base implementations of form methods. An event handler is a way for
you to write or copy code to a form that runs when a certain event
occurs, such as when data is modified. Not all properties or controls
can be edited when you create a form extension. For example, the
<strong>Name</strong> property might appear dimmed in the <strong>Properties</strong> window,
indicating that you cannot change it.</p>
<p>Some tasks can't be carried out by using an extension, for example, if you require a different form pattern and not all form patterns are available with an extension. In that case, you would create a new form, apply the necessary pattern, and then build the form according to the <strong>Pattern</strong> tab in the form designer window.</p>
<p>The following screenshot shows the addition of a tab to the Action Pane for the <code>FMCustomer</code> form extension, named <strong>FMCustomer.myExtension</strong>. A <strong>Button Group</strong> and <strong>Menu Item Button</strong> have also been added to the <strong>Action Pane Tab</strong> control. The existing elements in a form extension are shown in italic type, while the changed or added items are displayed in bold type.</p>
<p><a data-linktype="relative-path" href="media/form-extend.png#lightbox"><img alt="This is a screenshot from Visual Studio of an FMCustomer form
extension with an added Action Pane Tab, Button Group, and Menu Item
Button." data-linktype="relative-path" src="https://learn.microsoft.com/en-us/training/modules/extend-elements-finance-operations/media/form-extend.png"/></a></p>
<p>If a form doesn't have the needed data sources or fields, you can create a form extension to make the necessary modifications. After you've created an extension of the form, add a data source in the same manner that you would add a data source to a new form. Depending on the form pattern that is used, you can use the fields in the new table or data entity to populate the <strong>Grid</strong> control.</p>
<p>Follow these steps to create a form extension and add a new data source:</p>
<ol>
<li>Locate the form that you want to extend in the <strong>Application Explorer</strong> window by expanding <strong>AOT &gt; User Interface &gt; Forms</strong>.</li>
<li>Right-click the form and select <strong>Create extension</strong>. If this option
appears dimmed, you will need to set your project to reference the
model that contains that form.</li>
<li>In the <strong>Solution Explorer</strong> window, right-click your form
extension and select <strong>Rename</strong>. Add a company-specific
suffix, such as <code>.myExtension</code> or <code>.abcExtension</code>.</li>
<li>In the <strong>Solution Explorer</strong> window, right-click your form
extension and select <strong>Open</strong>.</li>
<li>In the <strong>Application Explorer</strong> window, expand <strong>AOT &gt; Data
Model &gt; Tables</strong>.</li>
<li>Select and drag your desired table from the <strong>Tables</strong> list to the
<strong>Data Sources</strong> node of the form.</li>
<li>Alternatively, you can select a table from your project in the
<strong>Solution Explorer</strong> window and drag it to the <strong>Data Sources</strong>
node of the form.</li>
<li>Now that you have the new data source added, you can expand the
table node and expand the <strong>Fields</strong> node within it to select and
drag fields to the <strong>Grid</strong> control in the design pane.</li>
</ol>
<div class="modular-content-container" hidden="" id="next-section">
</div>
</div>
<div class="section is-uniform position-relative" id="unit-inner-section">
<h1 class="margin-right-xxl-desktop" id="module-unit-title">Lab - Extend a form and add controls</h1>


<div hidden="" id="module-unit-notification-container"></div>
<h2 id="read-this-first---before-you-start-the-lab">Read this first - before you start the lab!</h2>
<div class="IMPORTANT">
<p>Important</p>
<p>For this lab, you CAN'T sign in with your own credentials. Use the following steps to sign in to your lab environment with the correct credentials.</p>
</div>
<ol>
<li>Ensure that you're signed in to Microsoft Learn.</li>
<li>Select <strong>Launch VM mode</strong> or <strong>Sign in to launch VM mode</strong> in this unit.</li>
<li>In the <strong>Resources</strong> tab on the lab side bar, select the <strong>T</strong> icon next to <strong>Password</strong> in the <strong>Finance and Operations</strong> box, to have the administrator password for the Virtual Machine (VM) entered for you.</li>
<li>Select <strong>Enter</strong>.</li>
<li>Microsoft Edge opens. Wait for it to navigate to the <strong>Sign in</strong> page for finance and operations. If you experience an issue with the <strong>Sign in</strong> page loading, try to restart the browser in the VM.</li>
<li>On the Microsoft <strong>Sign in</strong> page in finance and operations, place your mouse cursor into the <strong>Username</strong> field.</li>
<li>On the <strong>Resources</strong> tab of the lab side bar, below the <strong>Azure portal</strong> heading, select the <strong>T</strong> icon next to <strong>Username</strong>, then press <strong>Enter</strong>.</li>
<li>Your mouse cursor is now in the <strong>Password</strong> page.</li>
<li>On the <strong>Resources</strong> tab of the lab side bar, below the <strong>Azure portal</strong> heading, select the <strong>T</strong> icon next to select <strong>Password</strong>, then press <strong>Enter</strong>.</li>
<li>In the <strong>Save password</strong> window, select <strong>Never</strong>.</li>
<li>Select <strong>Accept</strong> in the <strong>Permissions requested</strong> page.</li>
<li>To see the lab instructions, select the <strong>Instructions</strong> tab on the lab side bar.</li>
</ol>
<p>You can now begin your work on this lab.</p>
<h2 id="scenario">Scenario</h2>
<p>The finance and operations apps developer has been asked by the Fleet
Management company to adjust the appearance and functionality of the <strong>Customers</strong> page in the <strong>Fleet management</strong> module. To speed up internal processes, the company wants a tab added to the Action Pane with a button that links to the page so they can enter a free text invoice.</p>
<h2 id="create-a-new-project">Create a new project</h2>
<ol>
<li>Minimize the Microsoft Edge window.</li>
<li>Select <strong>Run as administrator</strong> to open Visual Studio.</li>
<li>Select <strong>Yes</strong> in the <strong>Do you want to allow this app to make changes to your device?</strong> Window</li>
<li>Select <strong>Continue without code</strong> to open the Visual Studio.</li>
<li>Go to <strong>Dynamics 365</strong> in the <strong>Extensions</strong> menu in the ribbon in Visual Studio.</li>
<li>Select <strong>Model management &gt; Update model parameters</strong>.</li>
<li>Select the <strong>Fleet Management</strong> Model name from the model drop-down list.</li>
<li>Select <strong>Next</strong>.</li>
<li>Ensure the following models are referenced by selecting the checkmark next to the model:
<ul>
<li>Application Suite</li>
<li>Application Foundation</li>
<li>Application Common</li>
<li>Application Platform</li>
<li>Contact Person</li>
<li>Currency</li>
<li>General Ledger</li>
<li>Ledger</li>
<li>Personnel</li>
<li>Retail</li>
<li>Tax</li>
</ul>
</li>
<li>Select <strong>Next</strong>.</li>
<li>Select <strong>Finish</strong>.</li>
<li>Open the <strong>File</strong> menu and select <strong>New &gt; Project</strong>.</li>
<li>Ensure that <strong>Finance Operations</strong> is selected in the left pane, and then select <strong>Next</strong>.</li>
<li>In the <strong>Configure your new project</strong> dialog box enter <strong>FleetManagementFormProject</strong> in the <strong>Project name</strong> field.</li>
<li>Select <strong>Create</strong>.</li>
<li>Open <strong>Dynamics 365</strong> in the <strong>Extensions</strong> menu.</li>
<li>Select <strong>Options</strong>.</li>
<li>Under the <strong>Dynamics 365</strong> node on the left pane, select <strong>Projects</strong>.</li>
<li>Select the check boxes for <strong>Organize projects by element type</strong> and <strong>Synchronize database on build for newly created project</strong>.</li>
<li>Select <strong>OK</strong>.</li>
</ol>
<h2 id="extend-the-fmcustomer-form">Extend the FMCustomer form</h2>
<ol>
<li>In the search bar, in the <strong>Application Explorer</strong> window, expand the    <strong>AOT &gt; User Interface &gt; Forms</strong> nodes.</li>
<li>Select the <strong>FMCustomer</strong> form.</li>
<li>Right-click the <strong>FMCustomer</strong> form and select <strong>Create extension</strong>. An element named <strong>FMCustomer.FleetManagement</strong> will be added to your <strong>FleetManagementFormProject</strong> in the <strong>Solution Explorer</strong> window.</li>
<li>Rename the object <strong>FMCustomer.Extension</strong>.</li>
<li>Double-click the <strong>FMCustomer.Extension</strong> form in the <strong>Solution Explorer</strong> window to open it in the form designer window.</li>
<li>Select <strong>Save</strong> in the ribbon to save your progress.</li>
</ol>
<h2 id="add-a-tab-button-group-and-button-to-the-action-pane-control">Add a tab, button group, and button to the Action Pane control</h2>
<ol>
<li>On the right Design pane of the form designer, right-click the    <strong>ApplicationBar (Action Pane)</strong> control.</li>
<li>Select <strong>New &gt; Action Pane Tab</strong>. A new control has been added    named <strong>FormActionPaneTabControl1 (Action Pane Tab)</strong>.</li>
<li>Select the <strong>FormActionPaneTabControl1 (Action Pane Tab)</strong> heading.</li>
<li>In the <strong>Properties</strong> window, enter <strong>InvoicingTab</strong> for the
<strong>Name</strong> property and <strong>Invoicing</strong> for the <strong>Caption</strong> property.</li>
<li>On the Design pane, right-click the <strong>InvoicingTab (Action Pane    Tab)</strong> control and select <strong>New Button Group</strong>.</li>
<li>Select the <strong>FormButtonGroupControl1 (Button Group)</strong> heading.</li>
<li>In the <strong>Properties</strong> window, enter <strong>CustomersButtonGroup</strong> for the    <strong>Name</strong> property and <strong>Customers</strong> for the <strong>Caption</strong> property.</li>
<li>On the Design pane, right-click the <strong>CustomersButtonGroup (Button Group)</strong> control and select <strong>New &gt; Menu Item Button</strong>.</li>
<li>In the <strong>Properties</strong> window, for the <strong>Menu Item Name</strong> property,    select <strong>CustFreeInvoiceNew</strong> from the drop-down list.</li>
<li>Right-click the <strong>FMCustomer.Extension</strong> form in the <strong>Solution    Explorer</strong> window.</li>
<li>Select <strong>Set as Startup Object</strong>.</li>
<li>Perform a build by right-clicking <strong>FleetManagementFormProject</strong> in the <strong>Solution Explorer</strong> window and then selecting <strong>Build</strong>.</li>
<li>Run your form to view it in a browser window by selecting <strong>Debug &gt; Start Without Debugging</strong> from the ribbon. You can also use <strong>Ctrl + F5</strong>.</li>
<li>In the browser window, select the <strong>INVOICING</strong> tab on the Action    Pane and then select <strong>Free text invoice</strong>. You should be taken to the page to enter a free text invoice for the selected customer in the <strong>FMCustomer.Extension</strong> page.</li>
</ol>
<h3 id="now-close-the-lab-environment">Now close the lab environment</h3>
<ol>
<li>Select the <strong>Next</strong> button in the bottom-right corner of the side bar.</li>
<li>Select <strong>Leave</strong> in the pop-up window that appears.</li>
</ol>
<div class="modular-content-container" hidden="" id="next-section">
</div>
</div>
<div class="section is-uniform position-relative" id="unit-inner-section">
<h1 class="margin-right-xxl-desktop" id="module-unit-title">Extend menus</h1>


<div hidden="" id="module-unit-notification-container"></div>
<p>With finance and operations apps, you can connect menu items by changing existing menus with extensions.</p>
<p>Customizing an existing menu provides users with a more natural appearance and behavior because the new menu is like others that users interact with. You can create menu extensions in Microsoft Visual Studio.</p>
<p>In finance and operations apps, you can expand the <strong>Modules</strong> menu in the navigation pane and the menu for the module, as shown in the following screenshot.</p>
<p><a data-linktype="relative-path" href="media/modules-navigation-pane.png#lightbox"><img alt="Screenshot showing the Modules menu in the navigation pane." data-linktype="relative-path" src="https://learn.microsoft.com/en-us/training/modules/extend-elements-finance-operations/media/modules-navigation-pane.png"/></a></p>
<h2 id="add-menu-extensions-to-a-project">Add menu extensions to a project</h2>
<p>You can add menu extensions to a project by using the <strong>Solution Explorer</strong> window. Locate the applicable menu in <strong>Application Explorer</strong>, right-click or activate the context menu, select the menu, and then select <strong>Create Extension</strong>. The system adds a menu extension to the project by using the same menu name and appending the model name, as shown in the following screenshot example.</p>
<p><a data-linktype="relative-path" href="media/menu-extension.png#lightbox"><img alt="Screenshot showing the Menu Extensions folder." data-linktype="relative-path" src="https://learn.microsoft.com/en-us/training/modules/extend-elements-finance-operations/media/menu-extension.png"/></a></p>
<p>As another example, if you’re creating a menu extension for Accounts Payable for model MB500, you’d add a number to the postfix. Additionally, you can complete the following actions:</p>
<ul>
<li>Create extensions for standard menus. However, in the extended menu, you can’t change any property of the parent menu, except tags.</li>
<li>Modify the <strong>Label</strong> and <strong>Visible</strong> properties in the extended menu for child menus.</li>
<li>Change the <strong>Visible</strong> property of the <strong>MenuElementMenuItem</strong> node in the menu extension.</li>
<li>Add a new item to a menu after extending it. This approach helps distinguish a newly created form, such as report or class, in the UI of finance and operations apps.</li>
<li>Set a property’s view to false. However, you can’t remove menu or submenu items.</li>
</ul>
<p>In the Designer view, modifications to menu extensions are indicated with bold font, as the following screenshot shows.</p>
<p><a data-linktype="relative-path" href="media/modifications-bold-font.png#lightbox"><img alt="Screenshot showing the bold font of the menu extensions in the Designer view." data-linktype="relative-path" src="https://learn.microsoft.com/en-us/training/modules/extend-elements-finance-operations/media/modifications-bold-font.png"/></a></p>
<p>You must build menu extensions before they can be active and available for use.</p>
<div class="modular-content-container" hidden="" id="next-section">
</div>
</div>
<div class="section is-uniform position-relative" id="unit-inner-section">
<h1 class="margin-right-xxl-desktop" id="module-unit-title">Implement delegates</h1>


<div hidden="" id="module-unit-notification-container"></div>
<p>When you’re creating extensible solutions, you can use delegates by subscribing to the delegate in X++.</p>
<p>Delegates are composite data types that are part of how finance and operations apps can create extensions. You can define delegates on a method. Then, when the method is called, it'll also call their subscriber methods.</p>
<p>We don’t recommend that you create new delegates in the application. Rather, we recommend that you subscribe to existing delegates and then use Chain of Command (CoC), which provides a richer, more robust, and more concise extension mechanism that supersedes delegates.</p>
<p>Instead of creating delegates, structure your code into smaller methods so that you can use it in CoC.</p>
<p>If you use delegates, they’ll typically reside in the middle of a method because, if pre-events and post-events are present and CoC is used, they’ll be in the beginning and end of a method, respectively.</p>
<p>You can use delegates in the standard finance and operations apps, and they’re useful for independent software vendor (ISV) solutions.</p>
<p>Delegates in X++ must have the <strong>void</strong> return type. Also, delegates can be static and instance methods, and they can use the <strong>EventHandlerResult</strong> as a method parameter to return a result.</p>
<p>Subscribers for delegates aren’t in control of the implementation order.</p>
<h2 id="create-delegates">Create delegates</h2>
<p>Typically, you would create delegates in your code in tables, forms, or classes.</p>
<p>Make sure that you define the delegate in the code and then ensure that you define a call to the empty delegate so that subscribers can use it.</p>
<p>The following code sample shows how a delegate might appear in a class:</p>
<pre><code class="lang-xpp">/// &lt;summary&gt;
    /// Delegate for construct &lt;c&gt;MyCustTableClass&lt;/c&gt; instances.
    /// &lt;/summary&gt;
    /// &lt;param name = "_buffer"&gt;The buffer to create the instance from.&lt;/param&gt;
    /// &lt;param name = "_eventHandlerResult"&gt;An &lt;c&gt;EventHandlerResult&lt;/c&gt;&lt;/param&gt;
    static delegate void constructDelegate(Common _buffer,EventHandlerResult _eventHandlerResult)
    {
    }
</code></pre>
<p>You would call the delegates in the code as follows:</p>
<pre><code class="lang-xpp">/// &lt;summary&gt;
    /// Construct method &lt;c&gt;MyCustTableClass&lt;/c&gt; instances.
    /// &lt;/summary&gt;
    /// &lt;param name = "_buffer"&gt;The buffer to create the instance from.&lt;/param&gt;
    /// &lt;returns&gt;
    /// MyCustTableClass.
    /// &lt;/returns&gt;
    public static MyCustTableClass construct(Common _buffer)
    {
        switch (_buffer.TableId)
        {
            case tablenum(CustTable):
                return new MyCustTableClass(_buffer);

            default:
                EventHandlerResult result = EventHandlerResult::newSingleResponse();
                MyCustTableClass::constructDelegate(_buffer, result);
                if (result.hasResult())
                {
                    return result.result() as MyCustTableClass;
                }
                break;
        }

        throw error(Error::missingRecord(classstr(MyCustTableClass)));
    }

</code></pre>
<p>As shown in the preceding example, the call to the static <strong>MyCustTableClass::constructDelegate</strong> is done in the middle of the method, so you can’t use pre-events and post-events or CoC. Because you’ve created delegates, an extension is now enabled.</p>
<p>The system uses the <strong>EventHandlerResult</strong> to return the result, which you can validate.</p>
<h2 id="subscribe-to-a-delegate">Subscribe to a delegate</h2>
<p>You can perform extensions by subscribing to the delegate, which enables you to make modifications, as the following code sample shows:</p>
<pre><code class="lang-xpp">/// &lt;summary&gt;
    /// &lt;c&gt;MyCustTableClass&lt;/c&gt; class delegate subscriber.
    /// &lt;/summary&gt;
    [SubscribesTo(classstr(MyCustTableClass), staticDelegateStr(MyCustTableClass, constructDelegate))]
    public static void myConstruct(Common _buffer, EventHandlerResult _eventHandlerResult)
    {
        CustTable custTable = _buffer as CustTable;

        // do something

        _eventHandlerResult.result(custTable);
    }
</code></pre>
<p>Subscribers use the <strong>SubscribesTo</strong> attribute with the class name and delegate method name, and the system uses the <strong>EventHandlerResult</strong> method to set the desired result.</p>
<p>Using delegates can be useful, but the best practice is to use CoC because it provides a richer, more robust, and more concise extension mechanism. Additionally, you can apply CoC by splitting and structuring code into smaller pieces.</p>
<div class="modular-content-container" hidden="" id="next-section">
</div>
</div>
<div class="section is-uniform position-relative" id="unit-inner-section">
<h1 class="margin-right-xxl-desktop" id="module-unit-title">Check your knowledge</h1>


<div hidden="" id="module-unit-notification-container"></div>
<h2>Answer the following questions to see what you learned</h2>
<form aria-label="Knowledge check" class="quiz-form margin-top-xs" data-bi-name="quiz" role="form">
<fieldset class="field">
<div role="list">
<div class="quiz-question" data-bi-name="question" role="listitem">
<div aria-labelledby="quiz-question-1" class="quiz-question-title font-size-md margin-top-sm margin-bottom-xs" role="radiogroup">
<div class="margin-top-sm margin-bottom-xs field-label" id="quiz-question-1">
<span class="font-weight-semibold">1.</span>
<p>Which of the following statements is true regarding table extensions?</p>
<span class="required-indicator"></span>
</div>
<div class="field-body">
<label class="quiz-choice display-flex padding-block-xxs padding-inline-xs margin-bottom-xxs radio" for="quiz-choice-0-0">
<input class="radio-dot choice-input" id="quiz-choice-0-0" name="0" type="radio" value="0"/>
<div class="margin-inline-sm radio-label-text">
<p>The Properties window is used to edit any property for a table.</p>
</div>
</label>
<div class="quiz-choice-explanation margin-block-xxs font-weight-semibold margin-left-lg">
</div>
<label class="quiz-choice display-flex padding-block-xxs padding-inline-xs margin-bottom-xxs radio" for="quiz-choice-0-1">
<input class="radio-dot choice-input" id="quiz-choice-0-1" name="0" type="radio" value="1"/>
<div class="margin-inline-sm radio-label-text">
<p>While a new field can be added to a table extension, it is not possible to create a new index.</p>
</div>
</label>
<div class="quiz-choice-explanation margin-block-xxs font-weight-semibold margin-left-lg">
</div>
<label class="quiz-choice display-flex padding-block-xxs padding-inline-xs margin-bottom-xxs radio" for="quiz-choice-0-2">
<input class="radio-dot choice-input" id="quiz-choice-0-2" name="0" type="radio" value="2"/>
<div class="margin-inline-sm radio-label-text">
<p>You can use an event handler to add business logic to a table.</p>
</div>
</label>
<div class="quiz-choice-explanation margin-block-xxs font-weight-semibold margin-left-lg">
</div>
<label class="quiz-choice display-flex padding-block-xxs padding-inline-xs margin-bottom-xxs radio" for="quiz-choice-0-3">
<input class="radio-dot choice-input" id="quiz-choice-0-3" name="0" type="radio" value="3"/>
<div class="margin-inline-sm radio-label-text">
<p>Table extensions are used when the desired behavior of the element cannot be achieved through overlaying.</p>
</div>
</label>
<div class="quiz-choice-explanation margin-block-xxs font-weight-semibold margin-left-lg">
</div>
</div>
</div>
</div>
<div class="quiz-question" data-bi-name="question" role="listitem">
<div aria-labelledby="quiz-question-2" class="quiz-question-title font-size-md margin-top-sm margin-bottom-xs" role="radiogroup">
<div class="margin-top-sm margin-bottom-xs field-label" id="quiz-question-2">
<span class="font-weight-semibold">2.</span>
<p>You need to create an extension of the FMCustomer form.  Which of the following tasks cannot be accomplished after you have created the form extension?</p>
<span class="required-indicator"></span>
</div>
<div class="field-body">
<label class="quiz-choice display-flex padding-block-xxs padding-inline-xs margin-bottom-xxs radio" for="quiz-choice-1-0">
<input class="radio-dot choice-input" id="quiz-choice-1-0" name="1" type="radio" value="0"/>
<div class="margin-inline-sm radio-label-text">
<p>Change the form pattern from Details Master to Table of Contents.</p>
</div>
</label>
<div class="quiz-choice-explanation margin-block-xxs font-weight-semibold margin-left-lg">
</div>
<label class="quiz-choice display-flex padding-block-xxs padding-inline-xs margin-bottom-xxs radio" for="quiz-choice-1-1">
<input class="radio-dot choice-input" id="quiz-choice-1-1" name="1" type="radio" value="1"/>
<div class="margin-inline-sm radio-label-text">
<p>Add another data source to the form.</p>
</div>
</label>
<div class="quiz-choice-explanation margin-block-xxs font-weight-semibold margin-left-lg">
</div>
<label class="quiz-choice display-flex padding-block-xxs padding-inline-xs margin-bottom-xxs radio" for="quiz-choice-1-2">
<input class="radio-dot choice-input" id="quiz-choice-1-2" name="1" type="radio" value="2"/>
<div class="margin-inline-sm radio-label-text">
<p>Add an Action Pane Tab to the Action Pane control.</p>
</div>
</label>
<div class="quiz-choice-explanation margin-block-xxs font-weight-semibold margin-left-lg">
</div>
<label class="quiz-choice display-flex padding-block-xxs padding-inline-xs margin-bottom-xxs radio" for="quiz-choice-1-3">
<input class="radio-dot choice-input" id="quiz-choice-1-3" name="1" type="radio" value="3"/>
<div class="margin-inline-sm radio-label-text">
<p>Select and drag a field from the Fields node of a data source to a Grid control.</p>
</div>
</label>
<div class="quiz-choice-explanation margin-block-xxs font-weight-semibold margin-left-lg">
</div>
</div>
</div>
</div>
</div>
<div class="has-loading-skeleton" id="module-unit-quiz-submit-container"></div>
<p class="font-size-sm color-danger font-weight-semibold margin-top-xxs is-hidden" id="unanswered-question-error" role="alert">You must answer all questions before checking your work.</p>
<p class="visually-hidden" id="screen-reader-text"></p>
</fieldset>
</form>
<div class="modular-content-container" hidden="" id="next-section">
</div>
</div>
<div class="section is-uniform position-relative" id="unit-inner-section">
<h1 class="margin-right-xxl-desktop" id="module-unit-title">Summary</h1>


<div hidden="" id="module-unit-notification-container"></div>
<p>Extensions are a way to customize the finance and operations apps user
experience. If you need to adjust the performance, behavior, or
characteristics of an element, you can create an extension of that element from the AOT and make the necessary modifications. You can create an extension of a table if you need to add or remove fields, modify field
groups, add an index or table relation, modify available properties, or
add code or event handlers to the table. A form can be extended to
modify properties, add a data source, add or modify controls, or add
event handlers. A class extension is created to implement new event
handlers for a table or form.</p>
<p>By using extensions, you can make multiple adjustments to an element, or
just one adjustment. With most elements, you can't make all the adjustments that you'd like because some properties or controls are locked for editing. If the solution that you need can't be reached by creating an extension of the element, then you would create a new element.</p>
<h2 id="links-to-related-modules-and-sites-for-specific-topics">Links to related modules (and sites) for specific topics</h2>
<table>
<thead>
<tr>
<th>Topic</th>
<th>Link</th>
</tr>
</thead>
<tbody>
<tr>
<td>Extensibility</td>
<td><a data-linktype="absolute-path" href="/en-us/dynamics365/fin-ops-core/dev-itpro/extensibility/extensibility-home-page/?azure-portal=true">Extensibility home page</a></td>
</tr>
<tr>
<td>Create a new class extension, add new methods, and add event handler methods to a class.</td>
<td><a data-linktype="absolute-path" href="/en-us/training/modules/explore-extensions-framework-finance-operations/?azure-portal=true">Explore extensions and the extension framework in finance and operations apps</a></td>
</tr>
<tr>
<td>Business events provides an extension mechanism for integrations..</td>
<td><a data-linktype="absolute-path" href="/en-us/training/modules/business-events-finance-operations/?azure-portal=true">Consume business events in finance and operations apps</a></td>
</tr>
</tbody>
</table>
<div class="modular-content-container" hidden="" id="next-section">
</div>
</div>
<div class="section is-uniform position-relative" id="unit-inner-section">
<h1 class="margin-right-xxl-desktop" id="module-unit-title">Introduction</h1>


<div hidden="" id="module-unit-notification-container"></div>
<p>Business events occur when a business process is run. During a business
process, users who participate in it perform business actions to
complete the tasks that make up the business process.</p>
<p>In finance and operations apps, a business action that a
user performs can be either a workflow action or a non-workflow action.
Approval of a purchase requisition is an example of a workflow action,
whereas confirmation of a purchase order is an example of a non-workflow
action. Both types of actions can generate business events that external
systems can use in integration and notification scenarios.</p>
<p>Class extensions are used to implement new business events that allow
external systems to receive notifications from finance and operations apps.</p>
<p>To find existing business events in the instance you’re using, go to <strong>System administration &gt; Setup &gt; Business events &gt; Business event catalog</strong>. As shown in the  following screenshot, here you will find a list of all the business events that are available for use. You can also apply filters to search in each of the columns.</p>
<div class="mx-imgBorder">
<p><a data-linktype="relative-path" href="media/business-events.png#lightbox"><img alt="Screenshot of the Business events page." data-linktype="relative-path" src="https://learn.microsoft.com/en-us/training/modules/business-events-finance-operations/media/business-events.png"/></a></p>
</div>
<p>The next units will explore the business event framework and which steps to take to create a new business event.</p>
<div class="modular-content-container" hidden="" id="next-section">
</div>
</div>
<div class="section is-uniform position-relative" id="unit-inner-section">
<h1 class="margin-right-xxl-desktop" id="module-unit-title">Business event framework</h1>


<div hidden="" id="module-unit-notification-container"></div>
<p>The business events framework determines whether a business event is
published to a finance and operations apps user. It is best practice to have
the application send a business event, regardless of whether the
business event is enabled or not. If significant additional logic is needed, or if the logic for sending a business event has a performance impact, the system can check whether a specific business event is enabled before it runs business logic that is associated with sending business events.</p>
<p>Business events can be activated on the <strong>Business events</strong> page in the <strong>System administration</strong> module. In the catalog, all the business events can be viewed along with their status. By default, business events won’t be set to <strong>Active</strong> so they must go through an activation process.
To activate a business event, select one or multiple business events, and then select <strong>+Activate</strong> at the top left of the screen as shown in the following screenshot.</p>
<div class="mx-imgBorder">
<p><a data-linktype="relative-path" href="media/activate-event.png#lightbox"><img alt="Screenshot of the Business events page, showing the +Activate button." data-linktype="relative-path" src="https://learn.microsoft.com/en-us/training/modules/business-events-finance-operations/media/activate-event.png"/></a></p>
</div>
<p>When you have activated the business event, you can specify if this applies to multiple legal entities or just one. After a business event has been activated, it will appear in the <strong>Active business events</strong> tab  of the <strong>Business events</strong> page, and can be deactivated at anytime. If you deactivate it, it  will be listed in the <strong>Inactive business events</strong> tab.</p>
<p>Instead of deleting a business event, setting it to an <strong>Inactive</strong> status lets you retain the history of errors for that event, and can be activated later.</p>
<p>On occasion, when business processes or requirements change, a business event may no longer be needed and can be set to <strong>Inactive</strong>, where it can then be deleted later as needed.</p>
<h2 id="business-event-catalog">Business event catalog</h2>
<p>The <strong>Business events</strong> catalog can be accessed from <strong>System administration &gt; Set up &gt; Business events</strong>. The business event catalog lists the business events that are available in the instance that you're using. The catalog is useful because it shows which business events are available, and you can filter it by <strong>Category</strong>, <strong>Business event ID</strong>, and <strong>Name</strong>.</p>
<p>The category of a business event identifies its source. Business events that originate from the workflow system are assigned to the Workflow category. For business events that originate from other modules, the module name is used as the category name.</p>
<p>The business event catalog is built during database synchronization at the time of deployment. Therefore, users should see the complete list of business events in the catalog. However, if an explicit update of the catalog is required, you can select <strong>Manage &gt; Rebuild business events catalog</strong>.</p>
<p>For each business event, the business event catalog shows a description. This description can help you better understand the business event and its context in the business process. The catalog also shows the list of data fields that will be sent out in the event.</p>
<p>In scenarios where external integration systems require the schema of the payload for a business event during development, you can select <strong>Download schema</strong> to download the JavaScript Object Notation (JSON) schema.</p>
<p>In summary, the business event catalog helps identify the business events that are required for an implementation. It also helps identify the schema for each business event.</p>
<p>The next step is to manage the endpoints.</p>
<ul>
<li>Business events parameters</li>
<li>General</li>
</ul>
<p>The <strong>General</strong> tab of the <strong>Business events parameters</strong> page provides general settings that are applied to business events.</p>
<ul>
<li><strong>Retry count</strong> – The number of times that the system will try again to send business events to an endpoint if an error occurs. The default value is 3.</li>
<li><strong>Wait time between retries</strong> – The interval, in milliseconds, between attempts to send a business event to its endpoint. The default value is 1000 milliseconds.</li>
<li><strong>Endpoints allowed per event</strong> – The maximum number of endpoints that can subscribe to the same business event in a legal entity. The default value is 10.</li>
<li><strong>Use business events batch job</strong> – The business events batch processing job is available when a workaround is required to mitigate issues with dedicated processing. If you enable this option, select the <strong>Business events batch job</strong> action to select settings for the batch job processor. For more information about the settings for dedicated processing, see the description of the <strong>Performance</strong> tab in the next section.</li>
<li><strong>Key vault secret cache interval</strong> – The number of minutes that the key vault secrets that are used for business events will be cached in memory before they are read and cached again from the configured key vault. The default value is 5 minutes.</li>
</ul>
<h2 id="performance">Performance</h2>
<p>The business events framework has two primary settings that can affect performance:</p>
<ul>
<li>Processing threads</li>
<li>Bundle size</li>
</ul>
<p>The application allocates dedicated batch threads to process business events in near-real time. Because threads are a shared resource for all batch processing, you must take care when you decide to change the thread allocation for business events.</p>
<ul>
<li><strong>Processing threads</strong> – The number of threads to use to process business events. The maximum value is 4.
<ul>
<li>If you're using dedicated processing for business events, the thread count is the number per Batch Application Object Server (AOS) instance.</li>
<li>If you're using a batch job, the thread count is the total number of additional batch tasks that will be used to process events.</li>
</ul>
</li>
<li><strong>Bundle size</strong> – The number of events to group together at a time for processing by a thread.
<ul>
<li>By increasing the number, you produce fewer bundles and reduce the ability to distribute the events to parallel threads.</li>
<li>By decreasing the number, you produce more bundles and increase the ability to distribute the events to parallel threads. However, if you make the number too small, you will cause unnecessary parallelization on small bundles.</li>
</ul>
</li>
</ul>
<div class="modular-content-container" hidden="" id="next-section">
</div>
</div>
<div class="section is-uniform position-relative" id="unit-inner-section">
<h1 class="margin-right-xxl-desktop" id="module-unit-title">Create a new business event</h1>


<div hidden="" id="module-unit-notification-container"></div>
<p>To implement a new business event, you need to build a contract, build the event, and then add code to send the event.</p>
<p>Two classes are implemented for a new event: a business event class and
a business events contract class. The business event class extends the
<code>BusinessEventsBase</code> class and supports constructing the
business event, building the payload, and sending the business event.
The name should include the noun or phrase that corresponds with the
event, followed by the <code>BusinessEvent</code> suffix, such as
<code>CustomerInvoicePostedBusinessEvent</code>.</p>
<p>First you will need to create the SalesInvoicePostedBusinessEvent class.</p>
<p>Extend the <code>BusinessEventsBase</code> class. Labels must be defined for the name and description arguments, but the at "@" symbol should be left out to avoid storing localized data. The <code>BusinessEvents</code> attribute provides the business events framework with information about the business event's contract, name, and description.</p>
<pre><code class="lang-xpp"> [BusinessEvents(classStr(SalesInvoicePostedBusinessEventContract),
 "AccountsReceivable:SalesOrderInvoicePostedBusinessEventName","AccountsReceivable:SalesOrderInvoicePostedBusinessEventDescription",ModuleAxapta::SalesOrder)]
 	public class SalesInvoicePostedBusinessEvent extends BusinessEventsBase
</code></pre>
<p>After the class is created, use the following procedure to add methods to your class. The code examples define the <code>SalesInvoicePostedBusinessEvent</code> event.</p>
<ol>
<li><p>Add a static <code>newFrom&lt;my_buffer&gt;</code> method, filling in the <code>my_buffer</code> piece with the table buffer that is used to initialize the business event contract.</p>
<pre><code class="lang-xpp">static public SalesInvoicePostedBusinessEvent
newFromCustInvoiceJour(CustInvoiceJour _custInvoiceJour)
{
    SalesInvoicePostedBusinessEvent businessEvent = new
    SalesInvoicePostedBusinessEvent();
    businessEvent.parmCustInvoiceJour(_custInvoiceJour);
    return businessEvent;
}
</code></pre>
</li>
<li><p>Add <code>private parm</code> methods to maintain the internal state of the class.</p>
<pre><code class="lang-xpp">private CustInvoiceJour parmCustInvoiceJour(CustInvoiceJour_custInvoiceJour = custInvoiceJour)
{
    custInvoiceJour = _custInvoiceJour;
    return custInvoiceJour;
}
</code></pre>
</li>
<li><p>Add the <code>buildContract</code> method. The method must be decorated with the <code>Wrappable(true)</code> and <code>Replaceable(true)</code> attributes, and it will only be called when a business event is enabled for a company.</p>
<pre><code class="lang-xpp">[Wrappable(true), Replaceable(true)]
public BusinessEventsContract buildContract()
{
  return
  SalesInvoicePostedBusinessEventContract::newFromCustInvoiceJour(custInvoiceJour);
}
</code></pre>
</li>
</ol>
<h2 id="business-events-contract-class">Business events contract class</h2>
<p>The Business events contract class extends the
<code>BusinessEventsContract</code> class. It defines the payload of
the business event and allows the contract to be populated at runtime.</p>
<p>Use the following steps to extend the <code>BusinessEventContract</code>
class and add methods to the class. The code examples define the
<code>SalesInvoicePostedBusinessEventContract</code> event.</p>
<ol>
<li><p>Extend the <code>BusinessEventContract</code> class, ensuring that it's
decorated with the <code>DataContract</code> attribute.</p>
<pre><code class="lang-xpp">[DataContract]
public final class SalesInvoicePostedBusinessEventContract extends
BusinessEventsContract
</code></pre>
</li>
<li><p>Add <code>private</code> variables to hold the contract state.</p>
<pre><code class="lang-xpp">private CustInvoiceAccount      invoiceAccount;
private CustInvoiceId           invoiceId;
private SalesIdBase             salesId;
private TransDate               invoiceDate;
private DueDate                 invoiceDueDate;
private AmountMST               invoiceAmount;
private TaxAmount               invoiceTaxAmount;
private LegalEntityDataAreaId   legalEntity;
</code></pre>
</li>
<li><p>Add a <code>private</code> initialization method by using the <code>initialize</code> name. This method sets the business event contract class's private state, based on data that is provided through the <code>static</code> constructor method.</p>
<pre><code class="lang-xpp">private void initialize(CustInvoiceJour _custInvoiceJour)
{
    invoiceAccount = _custInvoiceJour.InvoiceAccount;
    invoiceId = _custInvoiceJour.InvoiceId;
    salesId = _custInvoiceJour.SalesId;
    invoiceDate = _custInvoiceJour.InvoiceDate;
    invoiceDueDate = _custInvoiceJour.DueDate;
    invoiceAmount = _custInvoiceJour.InvoiceAmountMST;
    invoiceTaxAmount = _custInvoiceJour.SumTaxMST;
    legalEntity = _custInvoiceJour.DataAreaId;
}
</code></pre>
</li>
<li><p>Add a <code>static</code> constructor method.</p>
<pre><code class="lang-xpp">public static SalesInvoicePostedBusinessEventContract
newFromCustInvoiceJour(CustInvoiceJour _custInvoiceJour)
{
    var contract = new SalesInvoicePostedBusinessEventContract();
    contract.initialize(_custInvoiceJour);
    return contract;
}
</code></pre>
</li>
<li><p>Add <code>parm</code> methods to access the contract state. These methods should be decorated with the <code>DataMember('')</code> and <code>BusinessEventsDataMember('')</code> attributes. To populate the data contract's internal state, you might need additional retrieval methods, which should be shown as <code>private</code> and called from the <code>initialize</code> method.</p>
<pre><code class="lang-xpp">[DataMember('InvoiceAccount'),
BusinessEventsDataMember("@AccountsReceivable:InvoiceAccount")]
public CustInvoiceAccount parmInvoiceAccount(CustInvoiceAccount_invoiceAccount = invoiceAccount)
{
    invoiceAccount = _invoiceAccount;
    return invoiceAccount;
}
</code></pre>
</li>
</ol>
<div class="modular-content-container" hidden="" id="next-section">
</div>
</div>
<div class="section is-uniform position-relative" id="unit-inner-section">
<h1 class="margin-right-xxl-desktop" id="module-unit-title">Activate business events</h1>


<div hidden="" id="module-unit-notification-container"></div>
<p>Business events in the business event catalog aren't active by default. From the catalog, you can activate any business events that you require. Select one or more business events, and then select <strong>Activate</strong>.</p>
<p>Business events can be activated either in all legal entities or in specific legal entities. If you leave the <strong>Legal entity</strong> field blank, the selected business events will be activated in all legal entities. If a business event is required only for specific legal entities, it must be configured separately for each legal entity.</p>
<p>Endpoints must be assigned to the business events that are activated. See <a data-linktype="absolute-path" href="/en-us/dynamics365/fin-ops-core/dev-itpro/business-events/managing-business-event-endpoints/?azure-portal=true">Manage business event endpoints</a> for more information on setting up and managing endpoints.</p>
<p>When business events occur as business processes are run, the system will do outbound processing only for business events that have been activated.</p>
<p>After business events are activated, they appear on the <strong>Active events</strong> tab.</p>
<p>From the <strong>Active events</strong> tab, you can inactivate business events. The system won't do outbound processing for inactivated events.</p>
<p>After business events are inactivated, they appear on the <strong>Inactive events</strong> tab.</p>
<p>Business events can be inactivated when processing of business events must be paused for a period because of specific system maintenance activities in the integration landscape.</p>
<p>When business requirements change, some business events might no longer be required. In this case, you can inactivate them instead of deleting them from the list of active events. This approach is useful if the history of errors for the business events must be preserved. Inactivated business events can be deleted later, when there is no longer a business need to keep them inactivated.</p>
<h2 id="errors">Errors</h2>
<p>While the system does outbound processing of business events, errors can occur. These errors might prevent the system from successfully delivering a business event to the endpoint. If an error occurs, the system retries several times to successfully process the business event. However, if all attempts are unsuccessful, the business event is saved in an error log.</p>
<p>Error logs can be accessed from the <strong>Active events</strong>, <strong>Inactive events</strong>, and <strong>Errors</strong> tabs. The <strong>Errors</strong> tab shows all errors across all business events, whereas the other two tabs show errors in the context of a specific business event.</p>
<p>You can do on-demand outbound processing on each error by using the <strong>Resend</strong> action. This action invokes the outbound processing logic. This logic includes retries. If the outbound processing is still unsuccessful, the error is logged in the error log. In this case, the <strong>Last process time</strong> field on the <strong>Errors</strong> tab indicates when the last attempt to process the event occurred.</p>
<p>If an error can't be successfully processed, you can use the <strong>Download payload</strong> option to download the payload from the event for offline processing, as you require.</p>
<div class="NOTE">
<p>Note</p>
<p>If an endpoint is deleted and a new endpoint is associated with business events, all errors that are associated with the business events can still be resent. In this case, the system will do outbound processing to send to the new endpoint that is associated with the corresponding business event. This functionality allows for graceful recovery from misconfiguration or other error states.</p>
</div>
<h2 id="subscribe-to-business-events-from-service">Subscribe to business events from service</h2>
<p>Users that have access to the privilege <strong>Subscribe to business events from service</strong> via their roles will be able to only see and subscribe to business events that have been assigned to their roles, which is described below. The organizational assignments that are done, if any, as part of role-based security is honored in the context of business events by letting users to only subscribe to business events in the organizations to which they have access to via their roles. This behavior is effective using any service calls like from Power Automate or Logic Apps.</p>
<h2 id="backward-compatibility">Backward compatibility</h2>
<p>To ensure backward compatibility, the following behavior must be understood.</p>
<ul>
<li>Role-based security for business events will be disabled by default.</li>
<li>Even if the feature is enabled in Feature management, role-based security will not take effect.</li>
<li>Role-based security must be explicitly enabled in the business events catalog via the <strong>Security</strong> menu.</li>
<li>After role-based security is enabled completely, security will be enforced henceforth. This will mean that any user with an administration role will not notice any change in behavior. However, any non-admin users either will see only business events that their roles were assigned to in the business events catalog security configuration or won't see any business events because their roles were not assigned to any business events.</li>
</ul>
<div class="modular-content-container" hidden="" id="next-section">
</div>
</div>
<div class="section is-uniform position-relative" id="unit-inner-section">
<h1 class="margin-right-xxl-desktop" id="module-unit-title">Consume business events</h1>


<div hidden="" id="module-unit-notification-container"></div>
<p>Different endpoint types can consume activated business events by subscribing to finance and operations apps events.</p>
<p>A business event is consumable when it‘s activated, and subscriptions depend on the type of endpoints that are available. Endpoint types for finance and operations apps include:</p>
<ul>
<li>Microsoft Azure Service Bus queue</li>
<li>Microsoft Azure Service Bus topic</li>
<li>Microsoft Azure Event Grid</li>
<li>Microsoft Azure Event Hubs</li>
<li>Microsoft Azure Blob Storage</li>
<li>HTTPS</li>
<li>Microsoft Power Automate</li>
<li>Microsoft Dataverse</li>
</ul>
<p>When you’re creating a business event from Power Automate, the business event in finance and operations apps is active and an endpoint is created.</p>
<p>In Dataverse, an endpoint is created when a plug-in or an SDK step is registered on a finance and operations apps business event or data event. Then, the endpoint is registered and becomes available on the <strong>Endpoints</strong> tab.</p>
<p>Business events are part of Microsoft Power Platform integration. Therefore, you need to ensure that your environment is deployed with <a data-linktype="absolute-path" href="/en-us/dynamics365/fin-ops-core/dev-itpro/power-platform/enable-power-platform-integration/?azure-portal=true">Power Platform Integration</a>, meaning that it can run only on an Azure-hosted environment but not on a local development virtual machine.</p>
<h2 id="business-events-and-power-automate">Business events and Power Automate</h2>
<p>You can set up business events in Power Automate with the <strong>When a Business Event occurs</strong> trigger. When the active finance and operations apps’ business event runs, it triggers the endpoint and performs the flow in Power Automate.</p>
<p>To set up Power Automate with a new flow, you need to add a trigger for business events by completing the following actions:</p>
<ol>
<li>Sign in to <a data-linktype="external" href="https://make.powerautomate.com/?azure-portal=true">Power Automate portal</a>.</li>
<li>Select the environment that’s connected to your finance and operations apps.</li>
<li>Select <strong>Create and Start from blank with an Automated cloud flow</strong>, and then enter a flow name.</li>
<li>Find the <strong>When a Business Event occurs</strong> trigger. We recommend that you search for <strong>Dynamics</strong> to narrow the search because many triggers exist.</li>
<li>Enter the instance. You might be prompted to sign in to the tool.</li>
<li>Enter information in the <strong>Category</strong> and <strong>Business event</strong> fields. The business event list that appears depends on the category that you choose.</li>
<li>Enter the applicable company in the <strong>Legal entity</strong> field.</li>
</ol>
<p>To add a new action step to a flow, follow these steps:</p>
<ol>
<li>Search for the <strong>Parse JSON data operation</strong> to parse the message with the data schema.</li>
<li>Select the <strong>Content</strong> field to show dynamic content. Select the <strong>Body</strong> field.</li>
<li>Go to <strong>finance and operations apps</strong>, <strong>Business event catalog</strong>, find the business events, and then select <strong>Download schema</strong>. The Business event schema downloads as a text file.</li>
<li>Open the text file and then copy its content to the clipboard.</li>
<li>Return to your flow, select <strong>Generate from sample</strong>, and then paste the text. A new JSON is generated.</li>
<li>Find the type <strong>integers</strong> and rename it to type <strong>number</strong> in Power Automate because the type isn’t set correctly.</li>
<li>Choose another action to consume by selecting <strong>+ New step</strong>,  <strong>Get a record (Fin &amp; Ops)</strong>.</li>
<li>Select the <strong>Instance</strong> from the dropdown menu.</li>
<li>From the <strong>Entity name</strong> dropdown menu, select the <strong>CustomersV3</strong> entity.</li>
<li>In the <strong>Object Id</strong> field, use the <strong>LegalEntity</strong> and <strong>InvoiceAccount</strong> dynamic content to find the customer. The syntax for the <strong>Object ID</strong> field is <em>DataAreaId,CustomerAccount</em> (a comma should be between the fields without spaces).</li>
<li>The <strong>ObjectId</strong> value should be set to company and the field(s) defined as a key on the entity in finance and operations apps. Now the flow can use all fields in the <strong>CustomersV3</strong> entity.</li>
<li>Add a final action by selecting <strong>+ New step</strong>, and then locate the <strong>Find Send an email (V2)</strong> action.</li>
<li>Choose an email account to which you want to send the message, and then enter a subject. You can use both fields from CustomersV3 and JSON as dynamic fields.</li>
<li>Enter a message in the email’s body that you want the recipient to read. You can use both fields from CustomersV3 and JSON as dynamic fields.</li>
<li>Select <strong>Save</strong> to save the flow.</li>
</ol>
<p>After you save the flow, you can locate it in the finance and operations app in the <strong>Active business events</strong> tab. Also, notice that an endpoint is created that points to Power Automate.</p>
<p>Additionally, the flow sends an email based on the information that you provided, as shown in the following image.</p>
<div class="mx-imgBorder">
<p><a data-linktype="relative-path" href="media/email.png#lightbox"><img alt="Screenshots showing the flow sending an email based on the information that is provided." data-linktype="relative-path" src="https://learn.microsoft.com/en-us/training/modules/business-events-finance-operations/media/email.png"/></a></p>
</div>
<h2 id="other-endpoints">Other endpoints</h2>
<p>Microsoft Learn documentation provides many tutorials for using business events for different endpoint types, including:</p>
<ul>
<li><a data-linktype="absolute-path" href="/en-us/dynamics365/fin-ops-core/dev-itpro/business-events/how-to/how-to-flow/?azure-portal=true">Business events and Microsoft Power Automate</a></li>
<li><a data-linktype="absolute-path" href="/en-us/dynamics365/fin-ops-core/dev-itpro/business-events/how-to/how-to-eventgrid/?azure-portal=true">Business events and Azure Event Grid</a></li>
<li><a data-linktype="absolute-path" href="/en-us/dynamics365/fin-ops-core/dev-itpro/business-events/how-to/how-to-servicebus/?azure-portal=true">Business events and Azure Service Bus</a></li>
<li><a data-linktype="absolute-path" href="/en-us/dynamics365/fin-ops-core/dev-itpro/business-events/how-to/how-to-servicebus-queue/?azure-portal=true">Business events and Azure Service Bus Queue</a></li>
<li><a data-linktype="absolute-path" href="/en-us/dynamics365/fin-ops-core/dev-itpro/business-events/how-to/how-to-workflow/?azure-portal=true">Business events and workflow approvals</a></li>
<li><a data-linktype="absolute-path" href="/en-us/dynamics365/fin-ops-core/dev-itpro/business-events/how-to/formspro/?azure-portal=true">Business events and Microsoft Forms Pro</a></li>
<li><a data-linktype="absolute-path" href="/en-us/dynamics365/fin-ops-core/dev-itpro/business-events/how-to/event-hub/?azure-portal=true">Business events and Azure Event Hubs</a></li>
<li><a data-linktype="absolute-path" href="/en-us/dynamics365/fin-ops-core/dev-itpro/business-events/how-to/how-to-dataverse-events/?azure-portal=true">Subscribe to events in Dataverse</a></li>
<li><a data-linktype="absolute-path" href="/en-us/dynamics365/fin-ops-core/dev-itpro/business-events/how-to/period-close/?azure-portal=true">Business events in financial period close</a></li>
</ul>
<div class="modular-content-container" hidden="" id="next-section">
</div>
</div>
<div class="section is-uniform position-relative" id="unit-inner-section">
<h1 class="margin-right-xxl-desktop" id="module-unit-title">Extend an existing business event</h1>


<div hidden="" id="module-unit-notification-container"></div>
<p>Business events are extensible, which means that you can add fields and business logic to existing business events so that a subscriber can use the added functionality.</p>
<p>To extend an existing business event, you need to create code extensions. Business events consist of two classes: a <strong>business event</strong> class and a <strong>business event contract</strong> class.</p>
<p>Typically, you can create a code extension for the <strong>business event contract</strong> class, depending on the business requirements for extending a business event.</p>
<h2 id="create-a-code-extension-for-a-business-event-contract-class">Create a code extension for a business event contract class</h2>
<p>To create a code extension for a business event, follow these steps.</p>
<ol>
<li><p>Go to the business event catalog in <strong>Dynamics 365 finance and operations apps</strong>, <strong>System administration</strong>, <strong>Setup</strong>, <strong>Business events</strong>, <strong>Business event catalog</strong> and then find the business event that you want to extend. The class name for the business event is defined in the <strong>Business event ID</strong> field.</p>
</li>
<li><p>Find the class in Microsoft Visual Studio by searching for the name in <strong>Application Explorer</strong>.</p>
</li>
<li><p>Right-click or activate the context menu for the class name and then select <strong>Create code extension</strong>. This action creates a new code extension named <strong>class name_model_Extension</strong> in your project in <strong>Solution Explorer</strong>.</p>
<p>After you open the class, you can add new functionality, as the following code sample illustrates:</p>
<pre><code class="lang-xpp"> [ExtensionOf(classStr(SalesInvoicePostedBusinessEventContract))]
 final class SalesInvoicePostedBusinessEventContract_MB500_Extension
 {
     private CustName name;

     [DataMember(‘Name’), BusinessEventsDataMember(“@AccountsReceivable:OrganizationName”)]
     public CustName parmName(CustName _name = name)
     {
         name = _name;

         return name;
     }

     public static SalesInvoicePostedBusinessEventContract newFromCustInvoiceJour(CustInvoiceJour _custInvoiceJour)
     {
         var contract = next newFromCustInvoiceJour(_custInvoiceJour);
         contract.myInitialize(_custInvoiceJour);

         return contract;
     }

     private void myInitialize(CustInvoiceJour _custInvoiceJour)
     {
         name = _custInvoiceJour.InvoicingName;
     }
 }
</code></pre>
<p>In the code sample, the <strong>SalesInvoicePostedBusinessEventContract</strong> class is extended and a new data member is created and initialized. Business data members use a data member name and a label.</p>
<p>Typically, an initialize() method on the contract class is called with a buffer from a table.</p>
<p>For the newFromCustInvoiceJour method, a Chain of Command (CoC) is created and a new method called <strong>myInitialize</strong> is added. The <strong>myInitialize</strong> method sets the new data member. Because the initialize() method is in the <strong>SalesInvoicePostBusinessEventContract</strong> class and therefore private, you can’t create CoC for this method.</p>
</li>
<li><p>Save the new class and then build the project in <strong>Solution Explorer</strong>.</p>
</li>
<li><p>Go to the <strong>Business event catalog</strong> and find the customized business event. Notice that the schema has changed and the new member is added, as the following screenshot shows.</p>
<div class="mx-imgBorder">
<p><a data-linktype="relative-path" href="media/download-schema.png#lightbox"><img alt="Screenshots showing the new member added to the schema." data-linktype="relative-path" src="https://learn.microsoft.com/en-us/training/modules/business-events-finance-operations/media/download-schema.png"/></a></p>
</div>
<p>After you extend a business event in finance and operations apps, subscribers should be able to use the new functionality.</p>
</li>
</ol>
<p>In the previous unit <strong>Consume business events</strong>, a Microsoft Power Automate flow was created by using the same business event. The following image shows how you can use the <strong>Get a record</strong> function to retrieve a name. Additionally, the image shows the addition of the data member for the name and that the <strong>Get a record</strong> function is no longer needed.</p>
<div class="mx-imgBorder">
<p><a data-linktype="relative-path" href="media/flow.png#lightbox"><img alt="Screenshot showing the Power Automate flow." data-linktype="relative-path" src="https://learn.microsoft.com/en-us/training/modules/business-events-finance-operations/media/flow.png"/></a></p>
</div>
<p>To update Parse JSON with the new schema, remove the <strong>Get a record</strong> function and then update <strong>Send an email (V2)</strong> to use the new data member:</p>
<ol>
<li>Find the business event in the business event catalog in finance and operations apps, and then download the updated schema.</li>
<li>Go to the flow in Power Automate, and then select <strong>Edit</strong> on the flow.</li>
<li>Select <strong>Parse JSON</strong>, <strong>Generate from a sample</strong>.</li>
<li>Copy the downloaded schema into the dialog that opened when you selected <strong>Generate from a sample</strong>, and then select <strong>Done</strong>.</li>
<li>Change the type of integer to a number in the schema.</li>
<li>Select <strong>Get a record</strong> and remove it by selecting the ellipsis (…) on the box, and then select <strong>Delete</strong>. Confirm the deletion when you’re prompted.</li>
<li>Select <strong>Send an email (V2)</strong>. Notice that the dynamic field from CustomersV3 is removed. Add a name from JSON instead.</li>
<li>Select <strong>Save</strong> to save the flow.</li>
</ol>
<p>The flow in Power Automate should now resemble the following image.</p>
<div class="mx-imgBorder">
<p><a data-linktype="relative-path" href="media/update-parse-json.png#lightbox"><img alt="Screenshot showing the result of the steps in this procedure." data-linktype="relative-path" src="https://learn.microsoft.com/en-us/training/modules/business-events-finance-operations/media/update-parse-json.png"/></a></p>
</div>
<p>You'll notice that <strong>Get a record</strong> is removed and the body for the email has changed to use <strong>Name</strong> from the JSON.</p>
<h2 id="test-the-business-event-extension">Test the business event extension</h2>
<p>To test the business event extension, follow these steps.</p>
<ol>
<li>Open finance and operations, and select <strong>Accounts Receivable</strong> in the navigation pane, and then select <strong>Orders</strong>, <strong>All sales orders</strong>.</li>
<li>Find a sales order with a status of <strong>Delivered</strong> and then select <strong>Invoice</strong>, <strong>Invoice</strong> to update the sales order.</li>
</ol>
<p>The Power Automate flow runs and sends an email by using the extension, as the following image illustrates.</p>
<div class="mx-imgBorder">
<p><a data-linktype="relative-path" href="media/extension-flow-email.png#lightbox"><img alt="Screenshot showing how the Power Automate flow runs and sends an email by using the extension." data-linktype="relative-path" src="https://learn.microsoft.com/en-us/training/modules/business-events-finance-operations/media/extension-flow-email.png"/></a></p>
</div>
<p>When you review the flow’s history, notice that the name is set to <strong>Whale Wholesales</strong> and is used in the email.</p>
<div class="modular-content-container" hidden="" id="next-section">
</div>
</div>
<div class="section is-uniform position-relative" id="unit-inner-section">
<h1 class="margin-right-xxl-desktop" id="module-unit-title">Role-based security for business events</h1>


<div hidden="" id="module-unit-notification-container"></div>
<p>Role-based security can be applied to business events to meet the following requirements using the appropriate security artifact.</p>
<table>
<thead>
<tr>
<th>Requirement</th>
<th>Privilege</th>
<th>Duty</th>
</tr>
</thead>
<tbody>
<tr>
<td>Only   certain users must have access to view the business events catalog.</td>
<td>BusinessEventsCatalogView</td>
<td>None</td>
</tr>
<tr>
<td>Only   certain users must have access to activate business events.</td>
<td>BusinessEventsCatalogMaintain</td>
<td>None</td>
</tr>
<tr>
<td>Only   certain users must have access to create and manage endpoints.</td>
<td>Business   events security privilege</td>
<td>Business   events security duty</td>
</tr>
<tr>
<td>Users must   only be able to subscribe to business events which they have been granted   access to from external applications like Power Automate.</td>
<td>Subscribe   to business events from service</td>
<td>None</td>
</tr>
<tr>
<td>Only   certain users must be able to view the business events security setup.</td>
<td>BusinessEventsCatalogSecuritySetupView</td>
<td>None</td>
</tr>
<tr>
<td>Only   certain users must be able to manage business events security.</td>
<td>Maintain   business events catalog security</td>
<td>None</td>
</tr>
</tbody>
</table>
<div class="modular-content-container" hidden="" id="next-section">
</div>
</div>
<div class="section is-uniform position-relative" id="unit-inner-section">
<h1 class="margin-right-xxl-desktop" id="module-unit-title">Business events in Microsoft Power Automate</h1>


<div hidden="" id="module-unit-notification-container"></div>
<p>Business events can be consumed in Microsoft Power Automate via the application connector. The connector has a trigger that is named <strong>When a business event occurs</strong>. This trigger can be used to subscribe to any of the business events that are available in the target instance of the application.</p>
<h2 id="subscribing-to-business-events-and-unsubscribing-from-them">Subscribing to business events and unsubscribing from them</h2>
<p>When a business event happens, trigger is added to a flow, the following information must be provided:</p>
<ul>
<li><strong>Instance</strong> – Specify the host name of the instance where business events occur. Environment instances should be available in the provided drop-down menu, but if an environment is not listed, it can be entered as a custom value.</li>
<li><strong>Category</strong> – Select the category of business events. The <strong>Business event</strong> field then shows the business events in that category.</li>
<li><strong>Business event</strong> – The available business events in the selected category.</li>
<li><strong>Legal entity</strong> – Specify the legal entity where the business event is being subscribed to. The flow will be triggered when the business event occurs in that legal entity. By default, this field is blank, and the business event is subscribed to in all legal entities.</li>
</ul>
<div class="modular-content-container" hidden="" id="next-section">
</div>
</div>
<div class="section is-uniform position-relative" id="unit-inner-section">
<h1 class="margin-right-xxl-desktop" id="module-unit-title">Check your knowledge</h1>


<div hidden="" id="module-unit-notification-container"></div>
<h2>Answer the following question to see what you learned</h2>
<form aria-label="Knowledge check" class="quiz-form margin-top-xs" data-bi-name="quiz" role="form">
<fieldset class="field">
<div role="list">
<div class="quiz-question" data-bi-name="question" role="listitem">
<div aria-labelledby="quiz-question-1" class="quiz-question-title font-size-md margin-top-sm margin-bottom-xs" role="radiogroup">
<div class="margin-top-sm margin-bottom-xs field-label" id="quiz-question-1">
<span class="font-weight-semibold">1.</span>
<p>What type of class supports constructing the business event, building the payload, and sending the business event?</p>
<span class="required-indicator"></span>
</div>
<div class="field-body">
<label class="quiz-choice display-flex padding-block-xxs padding-inline-xs margin-bottom-xxs radio" for="quiz-choice-0-0">
<input class="radio-dot choice-input" id="quiz-choice-0-0" name="0" type="radio" value="0"/>
<div class="margin-inline-sm radio-label-text">
<p>A business events contract class</p>
</div>
</label>
<div class="quiz-choice-explanation margin-block-xxs font-weight-semibold margin-left-lg">
</div>
<label class="quiz-choice display-flex padding-block-xxs padding-inline-xs margin-bottom-xxs radio" for="quiz-choice-0-1">
<input class="radio-dot choice-input" id="quiz-choice-0-1" name="0" type="radio" value="1"/>
<div class="margin-inline-sm radio-label-text">
<p>An event handler class</p>
</div>
</label>
<div class="quiz-choice-explanation margin-block-xxs font-weight-semibold margin-left-lg">
</div>
<label class="quiz-choice display-flex padding-block-xxs padding-inline-xs margin-bottom-xxs radio" for="quiz-choice-0-2">
<input class="radio-dot choice-input" id="quiz-choice-0-2" name="0" type="radio" value="2"/>
<div class="margin-inline-sm radio-label-text">
<p>An event class</p>
</div>
</label>
<div class="quiz-choice-explanation margin-block-xxs font-weight-semibold margin-left-lg">
</div>
<label class="quiz-choice display-flex padding-block-xxs padding-inline-xs margin-bottom-xxs radio" for="quiz-choice-0-3">
<input class="radio-dot choice-input" id="quiz-choice-0-3" name="0" type="radio" value="3"/>
<div class="margin-inline-sm radio-label-text">
<p>A business event class</p>
</div>
</label>
<div class="quiz-choice-explanation margin-block-xxs font-weight-semibold margin-left-lg">
</div>
</div>
</div>
</div>
<div class="quiz-question" data-bi-name="question" role="listitem">
<div aria-labelledby="quiz-question-2" class="quiz-question-title font-size-md margin-top-sm margin-bottom-xs" role="radiogroup">
<div class="margin-top-sm margin-bottom-xs field-label" id="quiz-question-2">
<span class="font-weight-semibold">2.</span>
<p>To retain a history of errors and remove a specific business event from a process, what status should the business event be changed to?</p>
<span class="required-indicator"></span>
</div>
<div class="field-body">
<label class="quiz-choice display-flex padding-block-xxs padding-inline-xs margin-bottom-xxs radio" for="quiz-choice-1-0">
<input class="radio-dot choice-input" id="quiz-choice-1-0" name="1" type="radio" value="0"/>
<div class="margin-inline-sm radio-label-text">
<p>Inactive</p>
</div>
</label>
<div class="quiz-choice-explanation margin-block-xxs font-weight-semibold margin-left-lg">
</div>
<label class="quiz-choice display-flex padding-block-xxs padding-inline-xs margin-bottom-xxs radio" for="quiz-choice-1-1">
<input class="radio-dot choice-input" id="quiz-choice-1-1" name="1" type="radio" value="1"/>
<div class="margin-inline-sm radio-label-text">
<p>Active</p>
</div>
</label>
<div class="quiz-choice-explanation margin-block-xxs font-weight-semibold margin-left-lg">
</div>
<label class="quiz-choice display-flex padding-block-xxs padding-inline-xs margin-bottom-xxs radio" for="quiz-choice-1-2">
<input class="radio-dot choice-input" id="quiz-choice-1-2" name="1" type="radio" value="2"/>
<div class="margin-inline-sm radio-label-text">
<p>Delete</p>
</div>
</label>
<div class="quiz-choice-explanation margin-block-xxs font-weight-semibold margin-left-lg">
</div>
</div>
</div>
</div>
<div class="quiz-question" data-bi-name="question" role="listitem">
<div aria-labelledby="quiz-question-3" class="quiz-question-title font-size-md margin-top-sm margin-bottom-xs" role="radiogroup">
<div class="margin-top-sm margin-bottom-xs field-label" id="quiz-question-3">
<span class="font-weight-semibold">3.</span>
<p>Which of the following business actions is a finance and operations user able to perform for their organization to handle daily tasks?</p>
<span class="required-indicator"></span>
</div>
<div class="field-body">
<label class="quiz-choice display-flex padding-block-xxs padding-inline-xs margin-bottom-xxs radio" for="quiz-choice-2-0">
<input class="radio-dot choice-input" id="quiz-choice-2-0" name="2" type="radio" value="0"/>
<div class="margin-inline-sm radio-label-text">
<p>Inactive or active business events</p>
</div>
</label>
<div class="quiz-choice-explanation margin-block-xxs font-weight-semibold margin-left-lg">
</div>
<label class="quiz-choice display-flex padding-block-xxs padding-inline-xs margin-bottom-xxs radio" for="quiz-choice-2-1">
<input class="radio-dot choice-input" id="quiz-choice-2-1" name="2" type="radio" value="1"/>
<div class="margin-inline-sm radio-label-text">
<p>External system tasks</p>
</div>
</label>
<div class="quiz-choice-explanation margin-block-xxs font-weight-semibold margin-left-lg">
</div>
<label class="quiz-choice display-flex padding-block-xxs padding-inline-xs margin-bottom-xxs radio" for="quiz-choice-2-2">
<input class="radio-dot choice-input" id="quiz-choice-2-2" name="2" type="radio" value="2"/>
<div class="margin-inline-sm radio-label-text">
<p>Workflow or nonworkflow actions</p>
</div>
</label>
<div class="quiz-choice-explanation margin-block-xxs font-weight-semibold margin-left-lg">
</div>
</div>
</div>
</div>
</div>
<div class="has-loading-skeleton" id="module-unit-quiz-submit-container"></div>
<p class="font-size-sm color-danger font-weight-semibold margin-top-xxs is-hidden" id="unanswered-question-error" role="alert">You must answer all questions before checking your work.</p>
<p class="visually-hidden" id="screen-reader-text"></p>
</fieldset>
</form>
<div class="modular-content-container" hidden="" id="next-section">
</div>
</div>
<div class="section is-uniform position-relative" id="unit-inner-section">
<h1 class="margin-right-xxl-desktop" id="module-unit-title">Summary</h1>


<div hidden="" id="module-unit-notification-container"></div>
<p>The intent behind capturing the business event must be clearly
understood. In other words, you need to determine the reason for capturing the business event and how it's going to be used by the recipient.</p>
<p>If the intent for capturing a business event is to take a business
action outside of finance and operations apps in response to the business
event that is happening in finance and operations apps, then this is a valid intent to capture the business event. The business action that is taken in response to the business event can be to notify users about the business event and/or to call into another business application to take a
business action like creating a sales order. It's important to consider
the business action generically and not base the need for a business
event on the type of business action that will be taken.</p>
<p>If the intent of capturing the business event is to transfer data to the
recipient and, in effect, realizing a data export scenario, then this
will not be a good use case for using business events. In fact, using
business events for data transfer use cases will be a misapplication of the business events framework. Such scenarios must continue to use data
export mechanisms that are already available in data management.</p>
<h2 id="use-cases-of-business-events">Use cases of business events</h2>
<p>These use cases aren't an exhaustive list of the potential use cases. Some of these use cases may not have been implemented yet either by Microsoft or other organizations. These use cases are meant to provide ideas and help with understanding business events.</p>
<ul>
<li>Procurement</li>
<li>Reporting</li>
<li>Customer master</li>
<li>Month-end close</li>
<li>Vendor master</li>
<li>Sales quotation</li>
<li>Workflows</li>
<li>Batch processing</li>
<li>Alerts</li>
<li>Case management</li>
</ul>
<h2 id="links-to-related-modules-and-sites-for-specific-topics">Links to related modules (and sites) for specific topics</h2>
<table>
<thead>
<tr>
<th>Topic</th>
<th>Link</th>
</tr>
</thead>
<tbody>
<tr>
<td>Business events</td>
<td><a data-linktype="absolute-path" href="/en-us/dynamics365/fin-ops-core/dev-itpro/business-events/home-page/?azure-portal=true">Business events overview</a></td>
</tr>
<tr>
<td>Troubleshooting</td>
<td><a data-linktype="absolute-path" href="/en-us/dynamics365/fin-ops-core/dev-itpro/business-events/troubleshooting/?azure-portal=true">Troubleshoot business events</a></td>
</tr>
<tr>
<td>Development process and best practices for implementing business events.</td>
<td><a data-linktype="absolute-path" href="/en-us/dynamics365/fin-ops-core/dev-itpro/business-events/business-events-dev-doc/?azure-portal=true">Business events developer documentation</a></td>
</tr>
<tr>
<td>Data management</td>
<td><a data-linktype="absolute-path" href="/en-us/training/modules/work-data-management-finance-operations/?azure-portal=true">Work with data management in finance and operations apps</a></td>
</tr>
<tr>
<td>Extend elements in finance and operations apps</td>
<td><a data-linktype="absolute-path" href="/en-us/training/modules/extend-elements-finance-operations/?azure-portal=true">Extend elements in finance and operations apps</a></td>
</tr>
</tbody>
</table>
<div class="modular-content-container" hidden="" id="next-section">
</div>
</div>
